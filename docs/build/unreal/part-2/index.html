<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Unreal Tutorial/Part-2" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">2 - Connecting to SpacetimeDB | SpacetimeDB docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.spacetimedb.com/unreal/part-2"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2 - Connecting to SpacetimeDB | SpacetimeDB docs"><meta data-rh="true" name="description" content="Need help with the tutorial? Join our Discord server!"><meta data-rh="true" property="og:description" content="Need help with the tutorial? Join our Discord server!"><link data-rh="true" rel="icon" href="/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.spacetimedb.com/unreal/part-2"><link data-rh="true" rel="alternate" href="https://docs.spacetimedb.com/unreal/part-2" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spacetimedb.com/unreal/part-2" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QBC7Z9KXS2-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"2 - Connecting to SpacetimeDB","item":"https://docs.spacetimedb.com/unreal/part-2"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="SpacetimeDB docs" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.0cb9f7a7.css">
<script src="/assets/js/runtime~main.d71df0f5.js" defer="defer"></script>
<script src="/assets/js/main.31d95d83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="https://spacetimedb.com/images/brand.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_6jFv" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://spacetimedb.com/images/brand.png" alt="SpacetimeDB Logo" class="themedComponent_rvet themedComponent--light_mbAJ"><img src="https://spacetimedb.com/images/brand.png" alt="SpacetimeDB Logo" class="themedComponent_rvet themedComponent--dark_Ncy6"></div></a><div class="navbarSearchContainer_AesG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://spacetimedb.com/install" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Install</a><a href="https://spacetimedb.com/pricing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a><a href="https://spacetimedb.com/maincloud" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Maincloud</a><a href="https://spacetimedb.com/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://spacetimedb.com/community" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_hV_y"><div class="docsWrapper_f07g"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_MJiz" type="button"></button><div class="docRoot_Gd2s"><aside class="theme-doc-sidebar-container docSidebarContainer_fSpF"><div class="sidebarViewport_YElg"><div class="sidebar_kjg4"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_AG0n"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/"><span title="Intro" class="categoryLinkLabel_EDYQ">Intro</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/deploying/maincloud"><span title="Deploying" class="categoryLinkLabel_EDYQ">Deploying</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/unity"><span title="Unity tutorial" class="categoryLinkLabel_EDYQ">Unity tutorial</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/unreal"><span title="Unreal Tutorial" class="categoryLinkLabel_EDYQ">Unreal Tutorial</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/unreal"><span title="Overview" class="linkLabel_dpMB">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/unreal/part-1"><span title="1 - Setup" class="linkLabel_dpMB">1 - Setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/unreal/part-2"><span title="2 - Connecting to SpacetimeDB" class="linkLabel_dpMB">2 - Connecting to SpacetimeDB</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/unreal/part-3"><span title="3 - Gameplay" class="linkLabel_dpMB">3 - Gameplay</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/unreal/part-4"><span title="4 - Moving and Colliding" class="linkLabel_dpMB">4 - Moving and Colliding</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cli-reference"><span title="CLI Reference" class="categoryLinkLabel_EDYQ">CLI Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/modules"><span title="Server Module Languages" class="categoryLinkLabel_EDYQ">Server Module Languages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sdks"><span title="Client SDK Languages" class="categoryLinkLabel_EDYQ">Client SDK Languages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sql"><span title="SQL" class="categoryLinkLabel_EDYQ">SQL</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/subscriptions"><span title="Subscriptions" class="categoryLinkLabel_EDYQ">Subscriptions</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rls"><span title="Row Level Security" class="linkLabel_dpMB">Row Level Security</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/how-to/incremental-migrations"><span title="How-To" class="categoryLinkLabel_EDYQ">How-To</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/spacetimeauth"><span title="SpacetimeAuth" class="categoryLinkLabel_EDYQ">SpacetimeAuth</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/http/authorization"><span title="HTTP API" class="categoryLinkLabel_EDYQ">HTTP API</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/webassembly-abi"><span title="Internals" class="categoryLinkLabel_EDYQ">Internals</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/appendix"><span title="Appendix" class="linkLabel_dpMB">Appendix</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_dkUT"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_w2oE"><div class="docItemContainer_f71m"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xsLZ" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_oyay"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Unreal Tutorial</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">2 - Connecting to SpacetimeDB</span></li></ul></nav><div class="tocCollapsible_dqme theme-doc-toc-mobile tocMobile_Z34P"><button type="button" class="clean-btn tocCollapsibleButton_QMSE">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Unreal Tutorial - Part 2 - Connecting to SpacetimeDB</h1></header>
<p>Need help with the tutorial? <a href="https://discord.gg/spacetimedb" target="_blank" rel="noopener noreferrer">Join our Discord server</a>!</p>
<p>This progressive tutorial is continued from <a href="/unreal/part-1">part 1</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="create-a-server-module">Create a Server Module<a href="#create-a-server-module" class="hash-link" aria-label="Direct link to Create a Server Module" title="Direct link to Create a Server Module" translate="no">​</a></h2>
<p>If you have not already installed the <code>spacetime</code> CLI, check out our <a href="/getting-started">Getting Started</a> guide for instructions on how to install.</p>
<p>In your <code>blackholio</code> directory, run the following command to initialize the SpacetimeDB server module project with your desired language:</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>Run the following command to initialize the SpacetimeDB server module project with Rust as the language:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> init</span><span style="color:#BD93F9"> --lang=rust</span><span style="color:#F1FA8C"> server-rust</span></span></code></pre><p>This command creates a new folder named <code>server-rust</code> alongside your Unreal project <code>client_unreal</code> directory and sets up the SpacetimeDB server project with Rust as the programming language.</p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Run the following command to initialize the SpacetimeDB server module project with C# as the language:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> init</span><span style="color:#BD93F9"> --lang=csharp</span><span style="color:#F1FA8C"> server-csharp</span></span></code></pre><p>This command creates a new folder named <code>server-csharp</code> alongside your Unreal project <code>client-unreal</code> directory and sets up the SpacetimeDB server project with C# as the programming language.</p></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="spacetimedb-tables">SpacetimeDB Tables<a href="#spacetimedb-tables" class="hash-link" aria-label="Direct link to SpacetimeDB Tables" title="Direct link to SpacetimeDB Tables" translate="no">​</a></h3>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>In this section we&#x27;ll be making some edits to the file <code>server-rust/src/lib.rs</code>. We recommend you open up this file in an IDE like VSCode or RustRover.</p><p><strong>Important: Open the <code>server-rust/src/lib.rs</code> file and delete its contents. We will be writing it from scratch here.</strong></p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>In this section we&#x27;ll be making some edits to the file <code>server-csharp/Lib.cs</code>. We recommend you open up this file in an IDE like VSCode or Rider.</p><p><strong>Important: Open the <code>server-csharp/Lib.cs</code> file and delete its contents. We will be writing it from scratch here.</strong></p></div></div></div>
<p>First we need to add some imports at the top of the file. Some will remain unused for now.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p><strong>Copy and paste into lib.rs:</strong></p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">time</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Duration</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">{rand</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Rng</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Identity</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">SpacetimeType</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">ReducerContext</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">ScheduleAt</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Table</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Timestamp</span><span style="color:#F8F8F2">};</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p><strong>Copy and paste into Lib.cs:</strong></p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">using</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> class</span><span style="color:#8BE9FD"> Module</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<p>We are going to start by defining a SpacetimeDB <em>table</em>. A <em>table</em> in SpacetimeDB is a relational database table which stores rows, similar to something you might find in SQL. SpacetimeDB tables differ from normal relational database tables in that they are stored fully in memory, are blazing fast to access, and are defined in your module code, rather than in SQL.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>Each row in a SpacetimeDB table is associated with a <code>struct</code> type in Rust.</p><p>Let&#x27;s start by defining the <code>Config</code> table. This is a simple table which will store some metadata about our game&#x27;s state. Add the following code to <code>lib.rs</code>.</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#6272A4">// We&#x27;re using this table as a singleton, so in this table</span></span>
<span class="line"><span style="color:#6272A4">// there only be one element where the `id` is 0.</span></span>
<span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">table(name </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> config, public)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Config</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    #[primary_key]</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> id</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> world_size</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u64</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>Let&#x27;s break down this code. This defines a normal Rust <code>struct</code> with two fields: <code>id</code> and <code>world_size</code>. We have decorated the struct with the <code>spacetimedb::table</code> macro. This procedural Rust macro signals to SpacetimeDB that it should create a new SpacetimeDB table with the row type defined by the <code>Config</code> type&#x27;s fields.</p><p>The <code>spacetimedb::table</code> macro takes two parameters, a <code>name</code> which is the name of the table and what you will use to query the table in SQL, and a <code>public</code> visibility modifier which ensures that the rows of this table are visible to everyone.</p><p>The <code>#[primary_key]</code> attribute, specifies that the <code>id</code> field should be used as the primary key of the table.</p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Each row in a SpacetimeDB table is associated with a <code>struct</code> type in C#.</p><p>Let&#x27;s start by defining the <code>Config</code> table. This is a simple table which will store some metadata about our game&#x27;s state. Add the following code inside the <code>Module</code> class in <code>Lib.cs</code>.</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#6272A4">// We&#x27;re using this table as a singleton, so in this table</span></span>
<span class="line"><span style="color:#6272A4">// there will only be one element where the `id` is 0.</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Table</span><span style="color:#F8F8F2">(Name </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">config</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, Public </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Config</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">PrimaryKey</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> id;</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> ulong</span><span style="color:#F8F8F2"> world_size;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>Let&#x27;s break down this code. This defines a normal C# <code>struct</code> with two fields: <code>id</code> and <code>world_size</code>. We have added the <code>[Table(Name = &quot;config&quot;, Public = true)]</code> attribute the struct. This attribute signals to SpacetimeDB that it should create a new SpacetimeDB table with the row type defined by the <code>Config</code> type&#x27;s fields.</p><blockquote>
<p>Although we&#x27;re using <code>lower_snake_case</code> for our column names to have consistent column names across languages in this tutorial, you can also use <code>camelCase</code> or <code>PascalCase</code> if you prefer. See <a href="https://github.com/clockworklabs/SpacetimeDB/issues/2168" target="_blank" rel="noopener noreferrer">#2168</a> for more information.</p>
</blockquote><p>The <code>Table</code> attribute takes two parameters, a <code>Name</code> which is the name of the table and what you will use to query the table in SQL, and a <code>Public</code> visibility modifier which ensures that the rows of this table are visible to everyone.</p><p>The <code>[PrimaryKey]</code> attribute, specifies that the <code>id</code> field should be used as the primary key of the table.</p></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_scYj alert alert--secondary"><div class="admonitionHeading_zhQc"><span class="admonitionIcon_kfZz"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_O7JJ"><p>The primary key of a row defines the &quot;identity&quot; of the row. A change to a row which doesn&#x27;t modify the primary key is considered an update, but if you change the primary key, then you have deleted the old row and inserted a new one.</p></div></div>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>You can learn more the <code>table</code> macro in our <a href="/modules/rust">Rust module reference</a>.</p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>You can learn more the <code>Table</code> attribute in our <a href="/modules/c-sharp">C# module reference</a>.</p></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="creating-entities">Creating Entities<a href="#creating-entities" class="hash-link" aria-label="Direct link to Creating Entities" title="Direct link to Creating Entities" translate="no">​</a></h3>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>Next, we&#x27;re going to define a new <code>SpacetimeType</code> called <code>DbVector2</code> which we&#x27;re going to use to store positions. The difference between a <code>#[derive(SpacetimeType)]</code> and a <code>#[spacetimedb(table)]</code> is that tables actually store data, whereas the deriving <code>SpacetimeType</code> just allows you to create a new column of that type in a SpacetimeDB table. Therefore, <code>DbVector2</code> is only a type, and does not define a table.</p><p><strong>Append to the bottom of lib.rs:</strong></p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#6272A4">// This allows us to store 2D points in tables.</span></span>
<span class="line"><span style="color:#F8F8F2">#[derive(</span><span style="color:#8BE9FD;font-style:italic">SpacetimeType</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Clone</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Debug</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> DbVector2</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> x</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> f32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> y</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> f32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>Let&#x27;s create a few tables to represent entities in our game.</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">table(name </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> entity, public)]</span></span>
<span class="line"><span style="color:#F8F8F2">#[derive(</span><span style="color:#8BE9FD;font-style:italic">Debug</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Clone</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Entity</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">    // The `auto_inc` attribute indicates to SpacetimeDB that</span></span>
<span class="line"><span style="color:#6272A4">    // this value should be determined by SpacetimeDB on insert.</span></span>
<span class="line"><span style="color:#F8F8F2">    #[auto_inc]</span></span>
<span class="line"><span style="color:#F8F8F2">    #[primary_key]</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> entity_id</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> position</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbVector2</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> mass</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">table(name </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> circle, public)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Circle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    #[primary_key]</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> entity_id</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    #[index(btree)]</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> player_id</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> direction</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbVector2</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> speed</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> f32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> last_split_time</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Timestamp</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">table(name </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> food, public)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Food</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    #[primary_key]</span></span>
<span class="line"><span style="color:#FF79C6">    pub</span><span style="color:#F8F8F2"> entity_id</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Next, we&#x27;re going to define a new <code>SpacetimeType</code> called <code>DbVector2</code> which we&#x27;re going to use to store positions. The difference between a <code>[SpacetimeDB.Type]</code> and a <code>[SpacetimeDB.Table]</code> is that tables actually store data, whereas the deriving <code>SpacetimeType</code> just allows you to create a new column of that type in a SpacetimeDB table. Therefore, <code>DbVector2</code> is only a type, and does not define a table.</p><p><strong>Append to the bottom of Lib.cs:</strong></p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#6272A4">// This allows us to store 2D points in tables.</span></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Type</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> DbVector2</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> float</span><span style="color:#F8F8F2"> x;</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> float</span><span style="color:#F8F8F2"> y;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#50FA7B"> DbVector2</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">float</span><span style="color:#FFB86C;font-style:italic"> x</span><span style="color:#F8F8F2">, </span><span style="color:#FF79C6">float</span><span style="color:#FFB86C;font-style:italic"> y</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        this</span><span style="color:#F8F8F2">.x </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> x;</span></span>
<span class="line"><span style="color:#BD93F9;font-style:italic">        this</span><span style="color:#F8F8F2">.y </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> y;</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>Let&#x27;s create a few tables to represent entities in our game by adding the following to the end of the <code>Module</code> class.</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Table</span><span style="color:#F8F8F2">(Name </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">entity</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, Public </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Entity</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2"> [</span><span style="color:#8BE9FD;font-style:italic">PrimaryKey</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">AutoInc</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> entity_id;</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#8BE9FD;font-style:italic"> DbVector2</span><span style="color:#F8F8F2"> position;</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> mass;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Table</span><span style="color:#F8F8F2">(Name </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">circle</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, Public </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Circle</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">PrimaryKey</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> entity_id;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Index</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">BTree</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> player_id;</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#8BE9FD;font-style:italic"> DbVector2</span><span style="color:#F8F8F2"> direction;</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> float</span><span style="color:#F8F8F2"> speed;</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Timestamp</span><span style="color:#F8F8F2"> last_split_time;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Table</span><span style="color:#F8F8F2">(Name </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">food</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, Public </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Food</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2"> [</span><span style="color:#8BE9FD;font-style:italic">PrimaryKey</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> entity_id;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<p>The first table we defined is the <code>entity</code> table. An entity represents an object in our game world. We have decided, for convenience, that all entities in our game should share some common fields, namely <code>position</code> and <code>mass</code>.</p>
<p>We can create different types of entities with additional data by creating new tables with additional fields that have an <code>entity_id</code> which references a row in the <code>entity</code> table.</p>
<p>We&#x27;ve created two types of entities in our game world: <code>Food</code>s and <code>Circle</code>s. <code>Food</code> does not have any additional fields beyond the attributes in the <code>entity</code> table, so the <code>food</code> table simply represents the set of <code>entity_id</code>s that we want to recognize as food.</p>
<p>The <code>Circle</code> table, however, represents an entity that is controlled by a player. We&#x27;ve added a few additional fields to a <code>Circle</code> like <code>player_id</code> so that we know which player that circle belongs to.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="representing-players">Representing Players<a href="#representing-players" class="hash-link" aria-label="Direct link to Representing Players" title="Direct link to Representing Players" translate="no">​</a></h3>
<p>Next, let&#x27;s create a table to store our player data.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">table(name </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> player, public)]</span></span>
<span class="line"><span style="color:#F8F8F2">#[derive(</span><span style="color:#8BE9FD;font-style:italic">Debug</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Clone</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Player</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    #[primary_key]</span></span>
<span class="line"><span style="color:#F8F8F2">    identity</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Identity</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    #[unique]</span></span>
<span class="line"><span style="color:#F8F8F2">    #[auto_inc]</span></span>
<span class="line"><span style="color:#F8F8F2">    player_id</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> u32</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    name</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> String</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>There&#x27;s a few new concepts we should touch on. First of all, we are using the <code>#[unique]</code> attribute on the <code>player_id</code> field. This attribute adds a constraint to the table that ensures that only one row in the player table has a particular <code>player_id</code>.</p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Table</span><span style="color:#F8F8F2">(Name </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">player</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, Public </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">)]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> struct</span><span style="color:#8BE9FD;font-style:italic"> Player</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2"> [</span><span style="color:#8BE9FD;font-style:italic">PrimaryKey</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#8BE9FD;font-style:italic"> Identity</span><span style="color:#F8F8F2"> identity;</span></span>
<span class="line"><span style="color:#F8F8F2"> [</span><span style="color:#8BE9FD;font-style:italic">Unique</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">AutoInc</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#FF79C6"> uint</span><span style="color:#F8F8F2"> player_id;</span></span>
<span class="line"><span style="color:#FF79C6"> public</span><span style="color:#FF79C6"> string</span><span style="color:#F8F8F2"> name;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>There are a few new concepts we should touch on. First of all, we are using the <code>[Unique]</code> attribute on the <code>player_id</code> field. This attribute adds a constraint to the table that ensures that only one row in the player table has a particular <code>player_id</code>. We are also using the <code>[AutoInc]</code> attribute on the <code>player_id</code> field, which indicates &quot;this field should get automatically assigned an auto-incremented value&quot;.</p></div></div></div>
<p>We also have an <code>identity</code> field which uses the <code>Identity</code> type. The <code>Identity</code> type is an identifier that SpacetimeDB uses to uniquely assign and authenticate SpacetimeDB users.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="writing-a-reducer">Writing a Reducer<a href="#writing-a-reducer" class="hash-link" aria-label="Direct link to Writing a Reducer" title="Direct link to Writing a Reducer" translate="no">​</a></h3>
<p>Next, we write our very first reducer. A reducer is a module function which can be called by clients. Let&#x27;s write a simple debug reducer to see how they work.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">reducer]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> fn</span><span style="color:#50FA7B"> debug</span><span style="color:#F8F8F2">(ctx</span><span style="color:#FF79C6">:</span><span style="color:#FF79C6"> &amp;</span><span style="color:#8BE9FD;font-style:italic">ReducerContext</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#8BE9FD;font-style:italic"> Result</span><span style="color:#F8F8F2">&lt;(), </span><span style="color:#8BE9FD;font-style:italic">String</span><span style="color:#F8F8F2">&gt; {</span></span>
<span class="line"><span style="color:#F8F8F2">    log</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">debug!</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;This reducer was called by {}.&quot;</span><span style="color:#F8F8F2">, ctx</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">sender);</span></span>
<span class="line"><span style="color:#8BE9FD;font-style:italic">    Ok</span><span style="color:#F8F8F2">(())</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Add this function to the <code>Module</code> class in <code>Lib.cs</code>:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Reducer</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> void</span><span style="color:#50FA7B"> Debug</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">ReducerContext</span><span style="color:#FFB86C;font-style:italic"> ctx</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    Log.</span><span style="color:#50FA7B">Info</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">$&quot;</span><span style="color:#F1FA8C">This reducer was called by </span><span style="color:#FF79C6">{</span><span style="color:#F8F8F2">ctx</span><span style="color:#F1FA8C">.</span><span style="color:#F8F8F2">Sender</span><span style="color:#FF79C6">}</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<p>This reducer doesn&#x27;t update any tables, it just prints out the <code>Identity</code> of the client that called it.</p>
<hr>
<p><strong>SpacetimeDB Reducers</strong></p>
<p>&quot;Reducer&quot; is a term coined by Clockwork Labs that refers to a function which when executed &quot;reduces&quot; a set of inserts and deletes into the database state. The term derives from functional programming and is closely related to <a href="https://redux.js.org/tutorials/fundamentals/part-2-concepts-data-flow#reducers" target="_blank" rel="noopener noreferrer">similarly named concepts</a> in other frameworks like React Redux. Reducers can be called remotely using the CLI, client SDK or can be scheduled to be called at some future time from another reducer call.</p>
<p>All reducers execute <em>transactionally</em> and <em>atomically</em>, meaning that from within the reducer it will appear as though all changes are being applied to the database immediately, however from the outside changes made in a reducer will only be applied to the database once the reducer completes successfully. If you return an error from a reducer or panic within a reducer, all changes made to the database will be rolled back, as if the function had never been called. If you&#x27;re unfamiliar with atomic transactions, it may not be obvious yet just how useful and important this feature is, but once you build a somewhat complex application it will become clear just how invaluable this feature is.</p>
<hr>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="publishing-the-module">Publishing the Module<a href="#publishing-the-module" class="hash-link" aria-label="Direct link to Publishing the Module" title="Direct link to Publishing the Module" translate="no">​</a></h3>
<p>Now that we have some basic functionality, let&#x27;s publish the module to SpacetimeDB and call our debug reducer.</p>
<p>In a new terminal window, run a local version of SpacetimeDB with the command:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> start</span></span></code></pre>
<p>This following log output indicates that SpacetimeDB is successfully running on your machine.</p>
<div class="language-text codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_p1l2"><pre tabindex="0" class="prism-code language-text codeBlock_qbrE thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Starting SpacetimeDB listening on 127.0.0.1:3000</span><br></span></code></pre></div></div>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>Now that SpacetimeDB is running we can publish our module to the SpacetimeDB host. In a separate terminal window, navigate to the <code>blackholio/server-rust</code> directory.</p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Now that SpacetimeDB is running we can publish our module to the SpacetimeDB host. In a separate terminal window, navigate to the <code>blackholio/server-csharp</code> directory.</p></div></div></div>
<p>If you are not already logged in to the <code>spacetime</code> CLI, run the <code>spacetime login</code> command to log in to your SpacetimeDB website account. Once you are logged in, run <code>spacetime publish --server local blackholio</code>. This will publish our Blackholio server logic to SpacetimeDB.</p>
<p>If the publish completed successfully, you will see something like the following in the logs:</p>
<div class="language-text codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_p1l2"><pre tabindex="0" class="prism-code language-text codeBlock_qbrE thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Build finished successfully.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Uploading to local =&gt; http://127.0.0.1:3000</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Publishing module...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Created new database with name: blackholio, identity: c200d2c69b4524292b91822afac8ab016c15968ac993c28711f68c6bc40b89d5</span><br></span></code></pre></div></div>
<blockquote>
<p>If you sign into <code>spacetime login</code> via GitHub, the token you get will be issued by <code>auth.spacetimedb.com</code>. This will also ensure that you can recover your identity in case you lose it. On the other hand, if you do <code>spacetime login --server-issued-login local</code>, you will get an identity which is issued directly by your local server. Do note, however, that <code>--server-issued-login</code> tokens are not recoverable if lost, and are only recognized by the server that issued them.</p>
</blockquote>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> call</span><span style="color:#F1FA8C"> blackholio</span><span style="color:#F1FA8C"> debug</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Next, use the <code>spacetime</code> command to call our newly defined <code>Debug</code> reducer:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> call</span><span style="color:#F1FA8C"> blackholio</span><span style="color:#F1FA8C"> Debug</span></span></code></pre></div></div></div>
<p>If the call completed successfully, that command will have no output, but we can see the debug logs by running:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> logs</span><span style="color:#F1FA8C"> blackholio</span></span></code></pre>
<p>You should see something like the following output:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">2025-01-09T16:08:38.144299Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> spacetimedb:</span><span style="color:#F1FA8C"> Creating</span><span style="color:#F1FA8C"> table</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">circle</span><span style="color:#F1FA8C">`</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-09T16:08:38.144438Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> spacetimedb:</span><span style="color:#F1FA8C"> Creating</span><span style="color:#F1FA8C"> table</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">config</span><span style="color:#F1FA8C">`</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-09T16:08:38.144451Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> spacetimedb:</span><span style="color:#F1FA8C"> Creating</span><span style="color:#F1FA8C"> table</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">entity</span><span style="color:#F1FA8C">`</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-09T16:08:38.144470Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> spacetimedb:</span><span style="color:#F1FA8C"> Creating</span><span style="color:#F1FA8C"> table</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">food</span><span style="color:#F1FA8C">`</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-09T16:08:38.144479Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> spacetimedb:</span><span style="color:#F1FA8C"> Creating</span><span style="color:#F1FA8C"> table</span><span style="color:#F1FA8C"> `</span><span style="color:#50FA7B">player</span><span style="color:#F1FA8C">`</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-09T16:08:38.144841Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> spacetimedb:</span><span style="color:#F1FA8C"> Database</span><span style="color:#F1FA8C"> initialized</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-09T16:08:47.306823Z</span><span style="color:#F1FA8C">  INFO:</span><span style="color:#F1FA8C"> src/lib.rs:68:</span><span style="color:#F1FA8C"> This</span><span style="color:#F1FA8C"> reducer</span><span style="color:#F1FA8C"> was</span><span style="color:#F1FA8C"> called</span><span style="color:#F1FA8C"> by</span><span style="color:#F1FA8C"> c200e1a6494dbeeb0bbf49590b8778abf94fae4ea26faf9769c9a8d69a3ec348.</span></span></code></pre>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="connecting-our-client">Connecting our Client<a href="#connecting-our-client" class="hash-link" aria-label="Direct link to Connecting our Client" title="Direct link to Connecting our Client" translate="no">​</a></h3>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>Next let&#x27;s connect our client to our database. Let&#x27;s start by modifying our <code>debug</code> reducer. Rename the reducer to be called <code>connect</code> and add <code>client_connected</code> in parentheses after <code>spacetimedb::reducer</code>. The end result should look like this:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">#[spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">reducer(client_connected)]</span></span>
<span class="line"><span style="color:#FF79C6">pub</span><span style="color:#FF79C6"> fn</span><span style="color:#50FA7B"> connect</span><span style="color:#F8F8F2">(ctx</span><span style="color:#FF79C6">:</span><span style="color:#FF79C6"> &amp;</span><span style="color:#8BE9FD;font-style:italic">ReducerContext</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">-&gt;</span><span style="color:#8BE9FD;font-style:italic"> Result</span><span style="color:#F8F8F2">&lt;(), </span><span style="color:#8BE9FD;font-style:italic">String</span><span style="color:#F8F8F2">&gt; {</span></span>
<span class="line"><span style="color:#F8F8F2">    log</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">debug!</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;{} just connected.&quot;</span><span style="color:#F8F8F2">, ctx</span><span style="color:#FF79C6">.</span><span style="color:#F8F8F2">sender);</span></span>
<span class="line"><span style="color:#8BE9FD;font-style:italic">    Ok</span><span style="color:#F8F8F2">(())</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>The <code>client_connected</code> argument to the <code>spacetimedb::reducer</code> macro indicates to SpacetimeDB that this is a special reducer. This reducer is only ever called by SpacetimeDB itself when a client connects to your database.</p><blockquote>
<p>SpacetimeDB gives you the ability to define custom reducers that automatically trigger when certain events occur.</p>
<ul>
<li><code>init</code> - Called the first time you publish your module and anytime you clear the database with <code>spacetime publish &lt;name&gt; --delete-data</code>.</li>
<li><code>client_connected</code> - Called when a user connects to the SpacetimeDB database. Their identity can be found in the <code>sender</code> value of the <code>ReducerContext</code>.</li>
<li><code>client_disconnected</code> - Called when a user disconnects from the SpacetimeDB database.</li>
</ul>
</blockquote></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Next let&#x27;s connect our client to our database. Let&#x27;s start by modifying our <code>Debug</code> reducer. Rename the reducer to be called <code>Connect</code> and add <code>ReducerKind.ClientConnected</code> in parentheses after <code>SpacetimeDB.Reducer</code>. The end result should look like this:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">[</span><span style="color:#8BE9FD;font-style:italic">Reducer</span><span style="color:#F8F8F2">(ReducerKind.ClientConnected)]</span></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> void</span><span style="color:#50FA7B"> Connect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">ReducerContext</span><span style="color:#FFB86C;font-style:italic"> ctx</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    Log.</span><span style="color:#50FA7B">Info</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">$&quot;</span><span style="color:#FF79C6">{</span><span style="color:#F8F8F2">ctx</span><span style="color:#F1FA8C">.</span><span style="color:#F8F8F2">Sender</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C"> just connected.</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre><p>The <code>ReducerKind.ClientConnected</code> argument to the <code>SpacetimeDB.Reducer</code> attribute indicates to SpacetimeDB that this is a special reducer. This reducer is only ever called by SpacetimeDB itself when a client connects to your database.</p><blockquote>
<p>SpacetimeDB gives you the ability to define custom reducers that automatically trigger when certain events occur.</p>
<ul>
<li><code>ReducerKind.Init</code> - Called the first time you publish your module and anytime you clear the database with <code>spacetime publish &lt;name&gt; --delete-data</code>.</li>
<li><code>ReducerKind.ClientConnected</code> - Called when a user connects to the SpacetimeDB database. Their identity can be found in the <code>Sender</code> value of the <code>ReducerContext</code>.</li>
<li><code>ReducerKind.ClientDisconnected</code> - Called when a user disconnects from the SpacetimeDB database.</li>
</ul>
</blockquote></div></div></div>
<p>Publish your module again by running:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> publish</span><span style="color:#BD93F9"> --server</span><span style="color:#F1FA8C"> local</span><span style="color:#F1FA8C"> blackholio</span></span></code></pre>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="generating-the-client">Generating the Client<a href="#generating-the-client" class="hash-link" aria-label="Direct link to Generating the Client" title="Direct link to Generating the Client" translate="no">​</a></h3>
<p>The <code>spacetime</code> CLI has built in functionality to let us generate Unreal C++ types that correspond to our tables, types, and reducers that we can use from our Unreal client.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>Let&#x27;s generate our types for our module. In the <code>blackholio/server-rust</code> directory run the following command:</p></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>Let&#x27;s generate our types for our module. In the <code>blackholio/server-csharp</code> directory run the following command:</p></div></div></div>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> generate</span><span style="color:#BD93F9"> --lang</span><span style="color:#F1FA8C"> unrealcpp</span><span style="color:#BD93F9"> --uproject-dir</span><span style="color:#F1FA8C"> ../client_unreal</span><span style="color:#BD93F9"> --project-path</span><span style="color:#F1FA8C"> ./</span><span style="color:#BD93F9"> --module-name</span><span style="color:#F1FA8C"> client_unreal</span></span></code></pre>
<p>This will generate a set of files in the <code>client_unreal/Source/client_unreal/Private/ModuleBindings</code> and <code>client_unreal/Source/client_unreal/Public/ModuleBindings</code> directories which contain the code generated types and reducer functions that are defined in your module, but usable on the client.</p>
<div class="theme-admonition theme-admonition-note admonition_scYj alert alert--secondary"><div class="admonitionHeading_zhQc"><span class="admonitionIcon_kfZz"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_O7JJ"><p><code>--uproject-dir</code> is straightforward as the path to the .uproject file. <code>--module-name</code> is the name of the Unreal module which in most projects is the name of the project, in this case <code>client_unreal</code>.</p></div></div>
<div class="language-text codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_p1l2"><pre tabindex="0" class="prism-code language-text codeBlock_qbrE thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── Reducers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   └── Connect.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── Tables</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── CircleTable.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── ConfigTable.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── EntityTable.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── FoodTable.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   └── PlayerTable.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">├── Types</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── CircleType.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── ConfigType.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── DbVector2Type.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── EntityType.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   ├── FoodType.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">│   └── PlayerType.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── ReducerBase.g.h</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">└── SpacetimeDBClient.g.h</span><br></span></code></pre></div></div>
<p>This will also generate a file in the <code>client_unreal/Source/client_unreal/Private/ModuleBindings/SpacetimeDBClient.g.h</code> directory with a type aware <code>UDbConnection</code> class. We will use this class to connect to your database from Unreal.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="connecting-to-the-database">Connecting to the Database<a href="#connecting-to-the-database" class="hash-link" aria-label="Direct link to Connecting to the Database" title="Direct link to Connecting to the Database" translate="no">​</a></h3>
<p>Update <code>client_unreal.Build.cs</code> to include the <code>SpacetimeDbSdk</code>. Add <code>SpacetimeDbSdk</code> and <code>Paper2D</code> to <code>PublicDependencyModuleNames</code>, and confirm that <code>PrivateDependencyModuleNames</code> includes the following modules for current and future needs:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">        PublicDependencyModuleNames.</span><span style="color:#50FA7B">AddRange</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6;font-weight:bold">new</span><span style="color:#F8F8F2"> string[]</span></span>
<span class="line"><span style="color:#F8F8F2">        {</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">Core</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">CoreUObject</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">Engine</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">InputCore</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">EnhancedInput</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">SpacetimeDbSdk</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">Paper2D</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">        });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">        PrivateDependencyModuleNames.</span><span style="color:#50FA7B">AddRange</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6;font-weight:bold">new</span><span style="color:#F8F8F2"> string[]</span></span>
<span class="line"><span style="color:#F8F8F2">        {</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">UMG</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">SlateCore</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#E9F284">            &quot;</span><span style="color:#F1FA8C">Slate</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">        });</span></span></code></pre>
<p>Update <code>GameManager.h</code> as follows to set up the Unreal client connection to the server:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">#pragma</span><span style="color:#50FA7B;font-style:italic"> once</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">CoreMinimal.h</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">GameFramework/Actor.h</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">ModuleBindings/SpacetimeDBClient.g.h</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">GameManager.generated.h</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> UDbConnection</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">UCLASS</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">class</span><span style="color:#F8F8F2"> CLIENT_UNREAL_API </span><span style="color:#8BE9FD">AGameManager</span><span style="color:#F8F8F2"> : </span><span style="color:#FF79C6">public</span><span style="color:#8BE9FD;font-style:italic"> AActor</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#50FA7B">    GENERATED_BODY</span><span style="color:#F8F8F2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public:</span></span>
<span class="line"><span style="color:#50FA7B">    AGameManager</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#FF79C6">    static</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2"> Instance;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">    UPROPERTY</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">EditAnywhere</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    FString ServerUri </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">127.0.0.1:3000</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#50FA7B">    UPROPERTY</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">EditAnywhere</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    FString ModuleName </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">blackholio</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#50FA7B">    UPROPERTY</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">EditAnywhere</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    FString TokenFilePath </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">.spacetime_blackholio</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">    UPROPERTY</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">BlueprintReadOnly</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    FSpacetimeDBIdentity LocalIdentity;</span></span>
<span class="line"><span style="color:#50FA7B">    UPROPERTY</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">BlueprintReadOnly</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    UDbConnection</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2"> Conn </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> nullptr</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">    UFUNCTION</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">BlueprintPure</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#FF79C6">    bool</span><span style="color:#50FA7B"> IsConnected</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">const</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#FF79C6">        return</span><span style="color:#F8F8F2"> Conn </span><span style="color:#FF79C6">!=</span><span style="color:#BD93F9"> nullptr</span><span style="color:#FF79C6"> &amp;&amp;</span><span style="color:#F8F8F2"> Conn</span><span style="color:#FF79C6">-&gt;</span><span style="color:#50FA7B">IsActive</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">    UFUNCTION</span><span style="color:#F8F8F2">(BlueprintCallable, Category</span><span style="color:#FF79C6">=</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">BH|Connection</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#FF79C6">    void</span><span style="color:#50FA7B"> Disconnect</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#FF79C6">        if</span><span style="color:#F8F8F2"> (Conn </span><span style="color:#FF79C6">!=</span><span style="color:#BD93F9"> nullptr</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">        {</span></span>
<span class="line"><span style="color:#F8F8F2">            Conn</span><span style="color:#FF79C6">-&gt;</span><span style="color:#50FA7B">Disconnect</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">            Conn </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> nullptr</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">        }</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">protected:</span></span>
<span class="line"><span style="color:#FF79C6">    virtual</span><span style="color:#FF79C6"> void</span><span style="color:#50FA7B"> BeginPlay</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">override</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">    virtual</span><span style="color:#FF79C6"> void</span><span style="color:#50FA7B"> EndPlay</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> EEndPlayReason</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Type</span><span style="color:#FFB86C;font-style:italic"> EndPlayReason</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">override</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public:</span></span>
<span class="line"><span style="color:#6272A4">    // Called every frame</span></span>
<span class="line"><span style="color:#FF79C6">    virtual</span><span style="color:#FF79C6"> void</span><span style="color:#50FA7B"> Tick</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">float</span><span style="color:#FFB86C;font-style:italic"> DeltaTime</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">override</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">private:</span></span>
<span class="line"><span style="color:#50FA7B">    UFUNCTION</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">    void</span><span style="color:#50FA7B"> HandleConnect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">UDbConnection</span><span style="color:#FF79C6">*</span><span style="color:#FFB86C;font-style:italic"> InConn</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">FSpacetimeDBIdentity</span><span style="color:#FFB86C;font-style:italic"> Identity</span><span style="color:#F8F8F2">, </span><span style="color:#FF79C6">const</span><span style="color:#8BE9FD;font-style:italic"> FString</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Token</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#50FA7B">    UFUNCTION</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">    void</span><span style="color:#50FA7B"> HandleConnectError</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">const</span><span style="color:#8BE9FD;font-style:italic"> FString</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Error</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#50FA7B">    UFUNCTION</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">    void</span><span style="color:#50FA7B"> HandleDisconnect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">UDbConnection</span><span style="color:#FF79C6">*</span><span style="color:#FFB86C;font-style:italic"> InConn</span><span style="color:#F8F8F2">, </span><span style="color:#FF79C6">const</span><span style="color:#8BE9FD;font-style:italic"> FString</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Error</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#50FA7B">    UFUNCTION</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">    void</span><span style="color:#50FA7B"> HandleSubscriptionApplied</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">FSubscriptionEventContext</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Context</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span></code></pre>
<p>Next, update GameManager.cpp to finalize the setup:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">GameManager.h</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#FF79C6">#include</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">Connection/Credentials.h</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">AGameManager</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">Instance </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> nullptr</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">AGameManager</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    PrimaryActorTick.bCanEverTick </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">    PrimaryActorTick.bStartWithTickEnabled </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">BeginPlay</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    Super</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">BeginPlay</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">    Instance </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9;font-style:italic"> this</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">    FOnConnectDelegate ConnectDelegate;</span></span>
<span class="line"><span style="color:#50FA7B">    BIND_DELEGATE_SAFE</span><span style="color:#F8F8F2">(ConnectDelegate, </span><span style="color:#BD93F9;font-style:italic">this</span><span style="color:#F8F8F2">, AGameManager, HandleConnect);</span></span>
<span class="line"><span style="color:#F8F8F2">    FOnDisconnectDelegate DisconnectDelegate;</span></span>
<span class="line"><span style="color:#50FA7B">    BIND_DELEGATE_SAFE</span><span style="color:#F8F8F2">(DisconnectDelegate, </span><span style="color:#BD93F9;font-style:italic">this</span><span style="color:#F8F8F2">, AGameManager, HandleDisconnect);</span></span>
<span class="line"><span style="color:#F8F8F2">    FOnConnectErrorDelegate ConnectErrorDelegate;</span></span>
<span class="line"><span style="color:#50FA7B">    BIND_DELEGATE_SAFE</span><span style="color:#F8F8F2">(ConnectErrorDelegate, </span><span style="color:#BD93F9;font-style:italic">this</span><span style="color:#F8F8F2">, AGameManager, HandleConnect);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">    UCredentials</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Init</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">TokenFilePath);</span></span>
<span class="line"><span style="color:#F8F8F2">    FString Token </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> UCredentials</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">LoadToken</span><span style="color:#F8F8F2">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">    UDbConnectionBuilder</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2"> Builder </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> UDbConnection</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Builder</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">                                                -&gt;</span><span style="color:#50FA7B">WithUri</span><span style="color:#F8F8F2">(ServerUri)</span></span>
<span class="line"><span style="color:#FF79C6">                                                -&gt;</span><span style="color:#50FA7B">WithModuleName</span><span style="color:#F8F8F2">(ModuleName)</span></span>
<span class="line"><span style="color:#FF79C6">                                                -&gt;</span><span style="color:#50FA7B">OnConnect</span><span style="color:#F8F8F2">(ConnectDelegate)</span></span>
<span class="line"><span style="color:#FF79C6">                                                -&gt;</span><span style="color:#50FA7B">OnDisconnect</span><span style="color:#F8F8F2">(DisconnectDelegate)</span></span>
<span class="line"><span style="color:#FF79C6">                                                -&gt;</span><span style="color:#50FA7B">OnConnectError</span><span style="color:#F8F8F2">(ConnectErrorDelegate);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">Token.</span><span style="color:#50FA7B">IsEmpty</span><span style="color:#F8F8F2">())</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#F8F8F2">        Builder</span><span style="color:#FF79C6">-&gt;</span><span style="color:#50FA7B">WithToken</span><span style="color:#F8F8F2">(Token);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">    Conn </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Builder</span><span style="color:#FF79C6">-&gt;</span><span style="color:#50FA7B">Build</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">EndPlay</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> EEndPlayReason</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">Type</span><span style="color:#FFB86C;font-style:italic"> EndPlayReason</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#50FA7B">    Disconnect</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (Instance </span><span style="color:#FF79C6">==</span><span style="color:#BD93F9;font-style:italic"> this</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#F8F8F2">        Instance </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> nullptr</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">    Super</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">EndPlay</span><span style="color:#F8F8F2">(EndPlayReason);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Tick</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">float</span><span style="color:#FFB86C;font-style:italic"> DeltaTime</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (</span><span style="color:#50FA7B">IsConnected</span><span style="color:#F8F8F2">())</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#F8F8F2">        Conn</span><span style="color:#FF79C6">-&gt;</span><span style="color:#50FA7B">FrameTick</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">HandleConnect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">UDbConnection</span><span style="color:#FF79C6">*</span><span style="color:#FFB86C;font-style:italic"> InConn</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD;font-style:italic">FSpacetimeDBIdentity</span><span style="color:#FFB86C;font-style:italic"> Identity</span><span style="color:#F8F8F2">, </span><span style="color:#FF79C6">const</span><span style="color:#8BE9FD;font-style:italic"> FString</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Token</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#50FA7B">    UE_LOG</span><span style="color:#F8F8F2">(LogTemp, Log, </span><span style="color:#50FA7B">TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Connected.</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#F8F8F2">    UCredentials</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">SaveToken</span><span style="color:#F8F8F2">(Token);</span></span>
<span class="line"><span style="color:#F8F8F2">    LocalIdentity </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Identity;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">    FOnSubscriptionApplied AppliedDelegate;</span></span>
<span class="line"><span style="color:#50FA7B">    BIND_DELEGATE_SAFE</span><span style="color:#F8F8F2">(AppliedDelegate, </span><span style="color:#BD93F9;font-style:italic">this</span><span style="color:#F8F8F2">, AGameManager, HandleSubscriptionApplied);</span></span>
<span class="line"><span style="color:#F8F8F2">    Conn</span><span style="color:#FF79C6">-&gt;</span><span style="color:#50FA7B">SubscriptionBuilder</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#FF79C6">        -&gt;</span><span style="color:#50FA7B">OnApplied</span><span style="color:#F8F8F2">(AppliedDelegate)</span></span>
<span class="line"><span style="color:#FF79C6">        -&gt;</span><span style="color:#50FA7B">SubscribeToAllTables</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">HandleConnectError</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">const</span><span style="color:#8BE9FD;font-style:italic"> FString</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Error</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#50FA7B">    UE_LOG</span><span style="color:#F8F8F2">(LogTemp, Log, </span><span style="color:#50FA7B">TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Connection error </span><span style="color:#BD93F9">%s</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">), </span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">Error);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">HandleDisconnect</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">UDbConnection</span><span style="color:#FF79C6">*</span><span style="color:#FFB86C;font-style:italic"> InConn</span><span style="color:#F8F8F2">, </span><span style="color:#FF79C6">const</span><span style="color:#8BE9FD;font-style:italic"> FString</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Error</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#50FA7B">    UE_LOG</span><span style="color:#F8F8F2">(LogTemp, Log, </span><span style="color:#50FA7B">TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Disconnected.</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#FF79C6">    if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">Error.</span><span style="color:#50FA7B">IsEmpty</span><span style="color:#F8F8F2">())</span></span>
<span class="line"><span style="color:#F8F8F2">    {</span></span>
<span class="line"><span style="color:#50FA7B">        UE_LOG</span><span style="color:#F8F8F2">(LogTemp, Log, </span><span style="color:#50FA7B">TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Disconnect error </span><span style="color:#BD93F9">%s</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">), </span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">Error);</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#F8F8F2"> AGameManager</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">HandleSubscriptionApplied</span><span style="color:#F8F8F2">(</span><span style="color:#8BE9FD;font-style:italic">FSubscriptionEventContext</span><span style="color:#FF79C6">&amp;</span><span style="color:#FFB86C;font-style:italic"> Context</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#50FA7B">    UE_LOG</span><span style="color:#F8F8F2">(LogTemp, Log, </span><span style="color:#50FA7B">TEXT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">Subscription applied!</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Here we configure the connection to the database, by passing it some callbacks in addition to providing the <code>SERVER_URI</code> and <code>MODULE_NAME</code> to the connection. When the client connects, the SpacetimeDB SDK will call the <code>HandleConnect</code> method, allowing us to start up the game.</p>
<p>In our <code>HandleConnect</code> callback we build a subscription and are calling <code>Subscribe</code> and subscribing to all data in the database. This will cause SpacetimeDB to synchronize the state of all your tables with your Unreal client&#x27;s SpacetimeDB SDK&#x27;s &quot;client cache&quot;. You can also subscribe to specific tables using SQL syntax, e.g. <code>SELECT * FROM my_table</code>. Our <a href="/sql">SQL documentation</a> enumerates the operations that are accepted in our SQL syntax.</p>
<hr>
<p><strong>SDK Client Cache</strong></p>
<p>The &quot;SDK client cache&quot; is a client-side view of the database defined by the supplied queries to the <code>Subscribe</code> function. SpacetimeDB ensures that the results of subscription queries are automatically updated and pushed to the client cache as they change which allows efficient access without unnecessary server queries.</p>
<hr>
<p>Now we&#x27;re ready to connect the client and server. Press the play button in Unreal.</p>
<p>If all went well you should see the below output in your Unreal logs.</p>
<div class="language-text codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_p1l2"><pre tabindex="0" class="prism-code language-text codeBlock_qbrE thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="token-line" style="color:#bfc7d5"><span class="token plain">UWebsocketManager::Connect: Connecting to ws://127.0.0.1:3000/v1/database/blackholio/subscribe?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Connected.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Subscription applied!</span><br></span></code></pre></div></div>
<p>Subscription applied indicates that the SpacetimeDB SDK has evaluated your subscription queries and synchronized your local cache with your database&#x27;s tables.</p>
<p>We can also see that the server has logged the connection as well.</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> logs</span><span style="color:#F1FA8C"> blackholio</span></span>
<span class="line"><span style="color:#8BE9FD">...</span></span>
<span class="line"><span style="color:#50FA7B">2025-01-10T03:51:02.078700Z</span><span style="color:#F1FA8C"> DEBUG:</span><span style="color:#F1FA8C"> src/lib.rs:63:</span><span style="color:#F1FA8C"> c200fb5be9524bfb8289c351516a1d9ea800f70a17a9a6937f11c0ed3854087d</span><span style="color:#F1FA8C"> just</span><span style="color:#F1FA8C"> connected.</span></span></code></pre>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps" translate="no">​</a></h3>
<p>You&#x27;ve learned how to setup a Unreal project with the SpacetimeDB SDK, write a basic SpacetimeDB server module, and how to connect your Unreal client to SpacetimeDB. That&#x27;s pretty much all there is to the setup. You&#x27;re now ready to start building the game.</p>
<p>In the <a href="/unreal/part-3">next part</a>, we&#x27;ll build out the functionality of the game and you&#x27;ll learn how to access your table data and call reducers in Unreal.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/unreal/part-1"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">1 - Setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/unreal/part-3"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3 - Gameplay</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Ea_L thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-a-server-module" class="table-of-contents__link toc-highlight">Create a Server Module</a><ul><li><a href="#spacetimedb-tables" class="table-of-contents__link toc-highlight">SpacetimeDB Tables</a></li><li><a href="#creating-entities" class="table-of-contents__link toc-highlight">Creating Entities</a></li><li><a href="#representing-players" class="table-of-contents__link toc-highlight">Representing Players</a></li><li><a href="#writing-a-reducer" class="table-of-contents__link toc-highlight">Writing a Reducer</a></li><li><a href="#publishing-the-module" class="table-of-contents__link toc-highlight">Publishing the Module</a></li><li><a href="#connecting-our-client" class="table-of-contents__link toc-highlight">Connecting our Client</a></li><li><a href="#generating-the-client" class="table-of-contents__link toc-highlight">Generating the Client</a></li><li><a href="#connecting-to-the-database" class="table-of-contents__link toc-highlight">Connecting to the Database</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"></div></footer></div>
</body>
</html>