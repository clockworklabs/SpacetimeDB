<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Row Level Security/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Row Level Security | SpacetimeDB docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.spacetimedb.com/rls"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Row Level Security | SpacetimeDB docs"><meta data-rh="true" name="description" content="Row Level Security (RLS) allows module authors to restrict which rows of a public table each client can access."><meta data-rh="true" property="og:description" content="Row Level Security (RLS) allows module authors to restrict which rows of a public table each client can access."><link data-rh="true" rel="icon" href="/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.spacetimedb.com/rls"><link data-rh="true" rel="alternate" href="https://docs.spacetimedb.com/rls" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spacetimedb.com/rls" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QBC7Z9KXS2-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Row Level Security","item":"https://docs.spacetimedb.com/rls"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="SpacetimeDB docs" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.0cb9f7a7.css">
<script src="/assets/js/runtime~main.d71df0f5.js" defer="defer"></script>
<script src="/assets/js/main.31d95d83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="https://spacetimedb.com/images/brand.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_6jFv" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://spacetimedb.com/images/brand.png" alt="SpacetimeDB Logo" class="themedComponent_rvet themedComponent--light_mbAJ"><img src="https://spacetimedb.com/images/brand.png" alt="SpacetimeDB Logo" class="themedComponent_rvet themedComponent--dark_Ncy6"></div></a><div class="navbarSearchContainer_AesG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://spacetimedb.com/install" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Install</a><a href="https://spacetimedb.com/pricing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a><a href="https://spacetimedb.com/maincloud" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Maincloud</a><a href="https://spacetimedb.com/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://spacetimedb.com/community" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_hV_y"><div class="docsWrapper_f07g"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_MJiz" type="button"></button><div class="docRoot_Gd2s"><aside class="theme-doc-sidebar-container docSidebarContainer_fSpF"><div class="sidebarViewport_YElg"><div class="sidebar_kjg4"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_AG0n"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/"><span title="Intro" class="categoryLinkLabel_EDYQ">Intro</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/deploying/maincloud"><span title="Deploying" class="categoryLinkLabel_EDYQ">Deploying</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/unity"><span title="Unity tutorial" class="categoryLinkLabel_EDYQ">Unity tutorial</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/unreal"><span title="Unreal Tutorial" class="categoryLinkLabel_EDYQ">Unreal Tutorial</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cli-reference"><span title="CLI Reference" class="categoryLinkLabel_EDYQ">CLI Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/modules"><span title="Server Module Languages" class="categoryLinkLabel_EDYQ">Server Module Languages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sdks"><span title="Client SDK Languages" class="categoryLinkLabel_EDYQ">Client SDK Languages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sql"><span title="SQL" class="categoryLinkLabel_EDYQ">SQL</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/subscriptions"><span title="Subscriptions" class="categoryLinkLabel_EDYQ">Subscriptions</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/rls"><span title="Row Level Security" class="linkLabel_dpMB">Row Level Security</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/how-to/incremental-migrations"><span title="How-To" class="categoryLinkLabel_EDYQ">How-To</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/spacetimeauth"><span title="SpacetimeAuth" class="categoryLinkLabel_EDYQ">SpacetimeAuth</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/http/authorization"><span title="HTTP API" class="categoryLinkLabel_EDYQ">HTTP API</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/webassembly-abi"><span title="Internals" class="categoryLinkLabel_EDYQ">Internals</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/appendix"><span title="Appendix" class="linkLabel_dpMB">Appendix</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_dkUT"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_w2oE"><div class="docItemContainer_f71m"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xsLZ" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_oyay"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Row Level Security</span></li></ul></nav><div class="tocCollapsible_dqme theme-doc-toc-mobile tocMobile_Z34P"><button type="button" class="clean-btn tocCollapsibleButton_QMSE">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Row Level Security (RLS)</h1></header>
<p>Row Level Security (RLS) allows module authors to restrict which rows of a public table each client can access.
These access rules are expressed in SQL and evaluated automatically for queries and subscriptions.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="enabling-rls">Enabling RLS<a href="#enabling-rls" class="hash-link" aria-label="Direct link to Enabling RLS" title="Direct link to Enabling RLS" translate="no">​</a></h2>
<p>RLS is currently <strong>experimental</strong> and must be explicitly enabled in your module.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>To enable RLS, activate the <code>unstable</code> feature in your project&#x27;s <code>Cargo.toml</code>:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#8BE9FD">spacetimedb</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> { </span><span style="color:#8BE9FD">version</span><span style="color:#FF79C6"> =</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">...</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">, </span><span style="color:#8BE9FD">features</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> [</span><span style="color:#E9F284">&quot;</span><span style="color:#F1FA8C">unstable</span><span style="color:#E9F284">&quot;</span><span style="color:#F8F8F2">] }</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>To enable RLS, include the following preprocessor directive at the top of your module files:</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">#pragma</span><span style="color:#FF79C6"> warning</span><span style="color:#FF79C6"> disable</span><span style="color:#F8F8F2"> STDB_UNSTABLE</span></span></code></pre></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="how-it-works">How It Works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How It Works" title="Direct link to How It Works" translate="no">​</a></h2>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><p>RLS rules are expressed in SQL and declared as constants of type <code>Filter</code>.</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">{client_visibility_filter, </span><span style="color:#8BE9FD;font-style:italic">Filter</span><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// A client can only see their account</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> ACCOUNT_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT * FROM account WHERE account.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><p>RLS rules are expressed in SQL and declared as public static readonly fields of type <code>Filter</code>.</p><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">using</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">#pragma</span><span style="color:#FF79C6"> warning</span><span style="color:#FF79C6"> disable</span><span style="color:#F8F8F2"> STDB_UNSTABLE</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> class</span><span style="color:#8BE9FD"> Module</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// A client can only see their account.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT * FROM account WHERE account.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<p>A module will fail to publish if any of its RLS rules are invalid or malformed.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="sender"><code>:sender</code><a href="#sender" class="hash-link" aria-label="Direct link to sender" title="Direct link to sender" translate="no">​</a></h3>
<p>You can use the special <code>:sender</code> parameter in your rules for user specific access control.
This parameter is automatically bound to the requesting client&#x27;s <a href="/#identity">Identity</a>.</p>
<p>Note that module owners have unrestricted access to all tables regardless of RLS.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="semantic-constraints">Semantic Constraints<a href="#semantic-constraints" class="hash-link" aria-label="Direct link to Semantic Constraints" title="Direct link to Semantic Constraints" translate="no">​</a></h3>
<p>RLS rules are similar to subscriptions in that logically they act as filters on a particular table.
Also like subscriptions, arbitrary column projections are <strong>not</strong> allowed.
Joins <strong>are</strong> allowed, but each rule must return rows from one and only one table.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="multiple-rules-per-table">Multiple Rules Per Table<a href="#multiple-rules-per-table" class="hash-link" aria-label="Direct link to Multiple Rules Per Table" title="Direct link to Multiple Rules Per Table" translate="no">​</a></h3>
<p>Multiple rules may be declared for the same table and will be evaluated as a logical <code>OR</code>.
This means clients will be able to see to any row that matches at least one of the rules.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example" translate="no">​</a></h4>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">{client_visibility_filter, </span><span style="color:#8BE9FD;font-style:italic">Filter</span><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// A client can only see their account</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> ACCOUNT_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT * FROM account WHERE account.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// An admin can see all accounts</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> ACCOUNT_FILTER_FOR_ADMINS</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">using</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">#pragma</span><span style="color:#FF79C6"> warning</span><span style="color:#FF79C6"> disable</span><span style="color:#F8F8F2"> STDB_UNSTABLE</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> class</span><span style="color:#8BE9FD"> Module</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// A client can only see their account.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT * FROM account WHERE account.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// An admin can see all accounts.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER_FOR_ADMINS </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="recursive-application">Recursive Application<a href="#recursive-application" class="hash-link" aria-label="Direct link to Recursive Application" title="Direct link to Recursive Application" translate="no">​</a></h3>
<p>RLS rules can reference other tables with RLS rules, and they will be applied recursively.
This ensures that data is never leaked through indirect access patterns.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="example-1">Example<a href="#example-1" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example" translate="no">​</a></h4>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">{client_visibility_filter, </span><span style="color:#8BE9FD;font-style:italic">Filter</span><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// A client can only see their account</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> ACCOUNT_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT * FROM account WHERE account.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// An admin can see all accounts</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> ACCOUNT_FILTER_FOR_ADMINS</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// Explicitly filtering by client identity in this rule is not necessary,</span></span>
<span class="line"><span style="color:#6272A4">/// since the above RLS rules on `account` will be applied automatically.</span></span>
<span class="line"><span style="color:#6272A4">/// Hence a client can only see their player, but an admin can see all players.</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> PLAYER_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT p.* FROM account a JOIN player p ON a.id = p.id&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">using</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> class</span><span style="color:#8BE9FD"> Module</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// A client can only see their account.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT * FROM account WHERE account.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// An admin can see all accounts.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER_FOR_ADMINS </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// Explicitly filtering by client identity in this rule is not necessary,</span></span>
<span class="line"><span style="color:#6272A4">    /// since the above RLS rules on `account` will be applied automatically.</span></span>
<span class="line"><span style="color:#6272A4">    /// Hence a client can only see their player, but an admin can see all players.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> PLAYER_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT p.* FROM account a JOIN player p ON a.id = p.id</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<p>And while self-joins are allowed, in general RLS rules cannot be self-referential,
as this would result in infinite recursion.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="example-self-join">Example: Self-Join<a href="#example-self-join" class="hash-link" aria-label="Direct link to Example: Self-Join" title="Direct link to Example: Self-Join" translate="no">​</a></h4>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">{client_visibility_filter, </span><span style="color:#8BE9FD;font-style:italic">Filter</span><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// A client can only see players on their same level</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> PLAYER_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span><span style="color:#F1FA8C">&quot;</span></span>
<span class="line"><span style="color:#F1FA8C">    SELECT q.*</span></span>
<span class="line"><span style="color:#F1FA8C">    FROM account a</span></span>
<span class="line"><span style="color:#F1FA8C">    JOIN player p ON a.id = p.id</span></span>
<span class="line"><span style="color:#F1FA8C">    JOIN player q on p.level = q.level</span></span>
<span class="line"><span style="color:#F1FA8C">    WHERE a.identity = :sender</span></span>
<span class="line"><span style="color:#F1FA8C">&quot;</span><span style="color:#F8F8F2">);</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">using</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> class</span><span style="color:#8BE9FD"> Module</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// A client can only see players on their same level.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> PLAYER_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">@&quot;</span></span>
<span class="line"><span style="color:#F1FA8C">        SELECT q.*</span></span>
<span class="line"><span style="color:#F1FA8C">        FROM account a</span></span>
<span class="line"><span style="color:#F1FA8C">        JOIN player p ON a.id = p.id</span></span>
<span class="line"><span style="color:#F1FA8C">        JOIN player q on p.level = q.level</span></span>
<span class="line"><span style="color:#F1FA8C">        WHERE a.identity = :sender</span></span>
<span class="line"><span style="color:#E9F284">    &quot;</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="example-recursive-rules">Example: Recursive Rules<a href="#example-recursive-rules" class="hash-link" aria-label="Direct link to Example: Recursive Rules" title="Direct link to Example: Recursive Rules" translate="no">​</a></h4>
<p>This module will fail to publish because each rule depends on the other one.</p>
<div class="theme-tabs-container tabs-container tabList_MbSD"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_Ssy3 tabs__item--active">Rust</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_Ssy3">C#</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_sydm"><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">use</span><span style="color:#F8F8F2"> spacetimedb</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">{client_visibility_filter, </span><span style="color:#8BE9FD;font-style:italic">Filter</span><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// An account must have a corresponding player</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> ACCOUNT_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT a.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">/// A player must have a corresponding account</span></span>
<span class="line"><span style="color:#F8F8F2">#[client_visibility_filter]</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#BD93F9"> PLAYER_FILTER</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6"> =</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#FF79C6">::</span><span style="color:#50FA7B">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F1FA8C">    &quot;SELECT p.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span></code></pre></div><div role="tabpanel" class="tabItem_sydm" hidden=""><pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">using</span><span style="color:#8BE9FD;font-style:italic"> SpacetimeDB</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">public</span><span style="color:#FF79C6"> partial</span><span style="color:#FF79C6"> class</span><span style="color:#8BE9FD"> Module</span></span>
<span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// An account must have a corresponding player.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT a.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#6272A4">    /// A player must have a corresponding account.</span></span>
<span class="line"><span style="color:#6272A4">    /// </span><span style="color:#F8F8F2">&lt;/</span><span style="color:#FF79C6">summary</span><span style="color:#F8F8F2">&gt;</span></span>
<span class="line"><span style="color:#F8F8F2">    [</span><span style="color:#8BE9FD;font-style:italic">SpacetimeDB</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">ClientVisibilityFilter</span><span style="color:#F8F8F2">]</span></span>
<span class="line"><span style="color:#FF79C6">    public</span><span style="color:#FF79C6"> static</span><span style="color:#FF79C6"> readonly</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2"> ACCOUNT_FILTER </span><span style="color:#FF79C6">=</span><span style="color:#FF79C6"> new</span><span style="color:#8BE9FD;font-style:italic"> Filter</span><span style="color:#F8F8F2">.</span><span style="color:#8BE9FD;font-style:italic">Sql</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        &quot;</span><span style="color:#F1FA8C">SELECT p.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">    );</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="usage-in-subscriptions">Usage in Subscriptions<a href="#usage-in-subscriptions" class="hash-link" aria-label="Direct link to Usage in Subscriptions" title="Direct link to Usage in Subscriptions" translate="no">​</a></h2>
<p>RLS rules automatically apply to subscriptions so that if a client subscribes to a table with RLS filters,
the subscription will only return rows that the client is allowed to see.</p>
<p>While the contraints and limitations outlined in the <a href="/sql#subscriptions">reference docs</a> do not apply to RLS rules,
they do apply to the subscriptions that use them.
For example, it is valid for an RLS rule to have more joins than are supported by subscriptions.
However a client will not be able to subscribe to the table for which that rule is defined.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices" translate="no">​</a></h2>
<ol>
<li>Use <code>:sender</code> for client specific filtering.</li>
<li>Follow the <a href="/sql#best-practices-for-performance-and-scalability">SQL best practices</a> for optimizing your RLS rules.</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/subscriptions/semantics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Subscription Semantics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/how-to/incremental-migrations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Incremental Migrations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Ea_L thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#enabling-rls" class="table-of-contents__link toc-highlight">Enabling RLS</a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight">How It Works</a><ul><li><a href="#sender" class="table-of-contents__link toc-highlight"><code>:sender</code></a></li><li><a href="#semantic-constraints" class="table-of-contents__link toc-highlight">Semantic Constraints</a></li><li><a href="#multiple-rules-per-table" class="table-of-contents__link toc-highlight">Multiple Rules Per Table</a></li><li><a href="#recursive-application" class="table-of-contents__link toc-highlight">Recursive Application</a></li></ul></li><li><a href="#usage-in-subscriptions" class="table-of-contents__link toc-highlight">Usage in Subscriptions</a></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"></div></footer></div>
</body>
</html>