"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4436],{623:(s,e,l)=>{l.d(e,{A:()=>A});var n=l(3303),r=l(3372),c=l(9607),o=l(2592),a=l(8368),i=l(1711),t=l(4541),F=l(4930),d=l(6022);function p(s){return n.Children.toArray(s).filter(s=>"\n"!==s).map(s=>{if(!s||(0,n.isValidElement)(s)&&function(s){const{props:e}=s;return!!e&&"object"==typeof e&&"value"in e}(s))return s;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof s.type?s.type:s.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(s){const{values:e,children:l}=s;return(0,n.useMemo)(()=>{const s=e??function(s){return p(s).map(({props:{value:s,label:e,attributes:l,default:n}})=>({value:s,label:e,attributes:l,default:n}))}(l);return function(s){const e=(0,F.XI)(s,(s,e)=>s.value===e.value);if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map(s=>s.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(s),s},[e,l])}function x({value:s,tabValues:e}){return e.some(e=>e.value===s)}function j({queryString:s=!1,groupId:e}){const l=(0,a.W6)(),r=function({queryString:s=!1,groupId:e}){if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!e)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return e??null}({queryString:s,groupId:e});return[(0,t.aZ)(r),(0,n.useCallback)(s=>{if(!r)return;const e=new URLSearchParams(l.location.search);e.set(r,s),l.replace({...l.location,search:e.toString()})},[r,l])]}function y(s){const{defaultValue:e,queryString:l=!1,groupId:r}=s,c=h(s),[o,a]=(0,n.useState)(()=>function({defaultValue:s,tabValues:e}){if(0===e.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!x({value:s,tabValues:e}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${e.map(s=>s.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const l=e.find(s=>s.default)??e[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:e,tabValues:c})),[t,F]=j({queryString:l,groupId:r}),[p,y]=function({groupId:s}){const e=function(s){return s?`docusaurus.tab.${s}`:null}(s),[l,r]=(0,d.Dv)(e);return[l,(0,n.useCallback)(s=>{e&&r.set(s)},[e,r])]}({groupId:r}),u=(()=>{const s=t??p;return x({value:s,tabValues:c})?s:null})();(0,i.A)(()=>{u&&a(u)},[u]);return{selectedValue:o,selectValue:(0,n.useCallback)(s=>{if(!x({value:s,tabValues:c}))throw new Error(`Can't select invalid tab value=${s}`);a(s),F(s),y(s)},[F,y,c]),tabValues:c}}var u=l(93);const m={tabList:"tabList_MbSD",tabItem:"tabItem_Ssy3"};var b=l(7711);function C({className:s,block:e,selectedValue:l,selectValue:n,tabValues:c}){const a=[],{blockElementScrollPositionUntilNextRender:i}=(0,o.a_)(),t=s=>{const e=s.currentTarget,r=a.indexOf(e),o=c[r].value;o!==l&&(i(e),n(o))},F=s=>{let e=null;switch(s.key){case"Enter":t(s);break;case"ArrowRight":{const l=a.indexOf(s.currentTarget)+1;e=a[l]??a[0];break}case"ArrowLeft":{const l=a.indexOf(s.currentTarget)-1;e=a[l]??a[a.length-1];break}}e?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":e},s),children:c.map(({value:s,label:e,attributes:n})=>(0,b.jsx)("li",{role:"tab",tabIndex:l===s?0:-1,"aria-selected":l===s,ref:s=>{a.push(s)},onKeyDown:F,onClick:t,...n,className:(0,r.A)("tabs__item",m.tabItem,n?.className,{"tabs__item--active":l===s}),children:e??s},s))})}function f({lazy:s,children:e,selectedValue:l}){const c=(Array.isArray(e)?e:[e]).filter(Boolean);if(s){const s=c.find(s=>s.props.value===l);return s?(0,n.cloneElement)(s,{className:(0,r.A)("margin-top--md",s.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:c.map((s,e)=>(0,n.cloneElement)(s,{key:e,hidden:s.props.value!==l}))})}function N(s){const e=y(s);return(0,b.jsxs)("div",{className:(0,r.A)(c.G.tabs.container,"tabs-container",m.tabList),children:[(0,b.jsx)(C,{...e,...s}),(0,b.jsx)(f,{...e,...s})]})}function A(s){const e=(0,u.A)();return(0,b.jsx)(N,{...s,children:p(s.children)},String(e))}},4513:(s,e,l)=>{l.r(e),l.d(e,{assets:()=>F,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Subscriptions/Subscription-Reference","title":"Subscription Reference","description":"The subscription API allows a client to replicate a subset of a database.","source":"@site/docs/09-Subscriptions/01-Subscription-Reference.md","sourceDirName":"09-Subscriptions","slug":"/subscriptions","permalink":"/subscriptions","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Subscription Reference","slug":"/subscriptions"},"sidebar":"sidebar","previous":{"title":"PostgreSQL Wire Protocol (PGWire)","permalink":"/docs/sql/pg-wire"},"next":{"title":"Subscription Semantics","permalink":"/subscriptions/semantics"}}');var r=l(7711),c=l(6119),o=l(623),a=l(8720);const i={title:"Subscription Reference",slug:"/subscriptions"},t="The SpacetimeDB Subscription API",F={},d=[{value:"SubscriptionBuilder",id:"subscriptionbuilder",level:2},{value:"Example Usage",id:"example-usage",level:3},{value:"SubscriptionHandle",id:"subscriptionhandle",level:2},{value:"Example Usage",id:"example-usage-1",level:3},{value:"Best Practices for Optimizing Server Compute and Reducing Serialization Overhead",id:"best-practices-for-optimizing-server-compute-and-reducing-serialization-overhead",level:2},{value:"1. Writing Efficient SQL Queries",id:"1-writing-efficient-sql-queries",level:3},{value:"2. Group Subscriptions with the Same Lifetime Together",id:"2-group-subscriptions-with-the-same-lifetime-together",level:3},{value:"Example",id:"example",level:4},{value:"3. Subscribe Before Unsubscribing",id:"3-subscribe-before-unsubscribing",level:3},{value:"Example",id:"example-1",level:4},{value:"4. Avoid Overlapping Queries",id:"4-avoid-overlapping-queries",level:3}];function p(s){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",span:"span",...(0,c.R)(),...s.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"the-spacetimedb-subscription-api",children:"The SpacetimeDB Subscription API"})}),"\n",(0,r.jsx)(e.p,{children:"The subscription API allows a client to replicate a subset of a database.\nIt does so by registering SQL queries, which we call subscriptions, through a database connection.\nA client will only receive updates for rows that match the subscriptions it has registered."}),"\n",(0,r.jsxs)(e.p,{children:["For more information on syntax and requirements see the ",(0,r.jsx)(e.a,{href:"/sql#subscriptions",children:"SQL docs"}),"."]}),"\n",(0,r.jsxs)(e.p,{children:["This guide describes the two main interfaces that comprise the API - ",(0,r.jsx)(e.code,{children:"SubscriptionBuilder"})," and ",(0,r.jsx)(e.code,{children:"SubscriptionHandle"}),".\nBy using these interfaces, you can create efficient and responsive client applications that only receive the data they need."]}),"\n",(0,r.jsx)(e.h2,{id:"subscriptionbuilder",children:"SubscriptionBuilder"}),"\n",(0,r.jsxs)(o.A,{groupId:"server-language",defaultValue:"rust",children:[(0,r.jsx)(a.A,{value:"rust",label:"Rust",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" struct"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"M"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeModule"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"> { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* private fields */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" }"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"impl"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"M"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeModule"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"> "}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"M"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"> {"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Register a callback that runs when the subscription has been applied."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// This callback receives a context containing the current state of the subscription."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" on_applied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"mut"}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:" self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", callback"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" impl"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" FnOnce"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"&"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"M"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SubscriptionEventContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"+"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Send"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" +"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" '"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"static"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:");"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Register a callback to run when the subscription fails."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Note that this callback may run either when attempting to apply the subscription,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// in which case [`Self::on_applied`] will never run,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// or later during the subscription's lifetime if the module's interface changes,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// in which case [`Self::on_applied`] may have already run."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" on_error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"mut"}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:" self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", callback"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" impl"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" FnOnce"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"&"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"M"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ErrorContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"crate::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"+"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Send"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" +"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" '"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"static"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:");"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Subscribe to a subset of the database via a set of SQL queries."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Returns a handle which you can use to monitor or drop the subscription later."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Queries"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" IntoQueries"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">("}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", query_sql"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Queries"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"->"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" M"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SubscriptionHandle"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Subscribe to all rows from all tables."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// This method is intended as a convenience"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// for applications where client-side memory use and network bandwidth are not concerns."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Applications where these resources are a constraint"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// should register more precise queries via [`Self::subscribe`]"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// in order to replicate only the subset of data which the client needs to function."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" subscribe_to_all_tables"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:");"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/// Types which specify a list of query strings."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" trait"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" IntoQueries"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" into_queries"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"->"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Box"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<["}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Box"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"str"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">]>;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})}),(0,r.jsx)(a.A,{value:"csharp",label:"C#",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" sealed"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" class"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD"},children:" SubscriptionBuilder"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Register a callback to run when the subscription is applied."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    public"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" OnApplied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"        Action"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SubscriptionEventContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"> "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"callback"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Register a callback to run when the subscription fails."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Note that this callback may run either when attempting to apply the subscription,"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// in which case "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"c"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"Self::on_applied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"c"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:" will never run,"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// or later during the subscription's lifetime if the module's interface changes,"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// in which case "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"c"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"Self::on_applied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"c"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:" may have already run."})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    public"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" OnError"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"        Action"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ErrorContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Exception"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"> "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"callback"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Subscribe to the following SQL queries."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// This method returns immediately, with the data not yet added to the DbConnection."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// The provided callbacks will be invoked once the data is returned from the remote server."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Data from all the provided queries will be returned at the same time."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// See the SpacetimeDB SQL docs for more information on SQL syntax:"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"a"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B",fontStyle:"italic"},children:" href"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"https://spacetimedb.com/docs/sql"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"https://spacetimedb.com/docs/sql"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"a"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    public"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SubscriptionHandle"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"querySqls"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Subscribe to all rows from all tables."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// This method is intended as a convenience"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// for applications where client-side memory use and network bandwidth are not concerns."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Applications where these resources are a constraint"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// should register more precise queries via "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"c"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"Self.Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"c"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// in order to replicate only the subset of data which the client needs to function."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" void"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" SubscribeToAllTables"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})})]}),"\n",(0,r.jsxs)(e.p,{children:["A ",(0,r.jsx)(e.code,{children:"SubscriptionBuilder"})," provides an interface for registering subscription queries with a database.\nIt allows you to register callbacks that run when the subscription is successfully applied or when an error occurs.\nOnce applied, a client will start receiving row updates to its client cache.\nA client can react to these updates by registering row callbacks for the appropriate table."]}),"\n",(0,r.jsx)(e.h3,{id:"example-usage",children:"Example Usage"}),"\n",(0,r.jsxs)(o.A,{groupId:"server-language",defaultValue:"rust",children:[(0,r.jsx)(a.A,{value:"rust",label:"Rust",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Establish a database connection"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" DbConnection"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" connect_to_db"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Register a subscription with the database"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" subscription_handle "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"on_applied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"ctx"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle applied state */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"on_error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"error_ctx, error"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle error */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'"SELECT * FROM user"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'"SELECT * FROM message"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"]);"})]})]})})})}),(0,r.jsx)(a.A,{value:"csharp",label:"C#",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Establish a database connection"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" ConnectToDB"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Register a subscription with the database"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" userSubscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"OnApplied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(("}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"ctx"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle applied state */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"OnError"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(("}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"errorCtx"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle error */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] { "}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM user"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM message"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" });"})]})]})})})})]}),"\n",(0,r.jsx)(e.h2,{id:"subscriptionhandle",children:"SubscriptionHandle"}),"\n",(0,r.jsxs)(o.A,{groupId:"server-language",defaultValue:"rust",children:[(0,r.jsx)(a.A,{value:"rust",label:"Rust",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"pub"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" trait"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SubscriptionHandle"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" InModule"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" +"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Clone"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" +"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Send"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" +"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" '"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"static"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"where"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"    Self"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Module"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeModule"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SubscriptionHandle"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:" Self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">,"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Returns `true` if the subscription has been ended."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// That is, if it has been unsubscribed or terminated due to an error."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" is_ended"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"&"}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"->"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" bool"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Returns `true` if the subscription is currently active."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" is_active"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"&"}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"->"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" bool"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Unsubscribe from the query controlled by this `SubscriptionHandle`,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// then run `on_end` when its rows are removed from the client cache."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Returns an error if the subscription is already ended,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// or if unsubscribe has already been called."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" unsubscribe_then"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", on_end"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" OnEndedCallback"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"Self"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Module"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">) "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"->"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" crate::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Result"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<()>;"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Unsubscribe from the query controlled by this `SubscriptionHandle`."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// Returns an error if the subscription is already ended,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"    /// or if unsubscribe has already been called."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    fn"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" unsubscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#BD93F9",fontStyle:"italic"},children:"self"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"->"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" crate::"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Result"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<()>;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})}),(0,r.jsx)(a.A,{value:"csharp",label:"C#",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" class"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD"},children:" SubscriptionHandle"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"SubscriptionEventContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"ErrorContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"> : "}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ISubscriptionHandle"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        where"}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:" SubscriptionEventContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" : "}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ISubscriptionEventContext"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        where"}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:" ErrorContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" : "}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"IErrorContext"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    {"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// Whether the subscription has ended."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" bool"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" IsEnded;"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// Whether the subscription is active."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" bool"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" IsActive;"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// Unsubscribe from the query controlled by this subscription handle."})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        ///"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// Calling this more than once will result in an exception."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" void"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" Unsubscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// Unsubscribe from the query controlled by this subscription handle,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// and call onEnded when its rows are removed from the client cache."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        /// "}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"</"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"summary"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        public"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" void"}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" UnsubscribeThen"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Action"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"<"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SubscriptionEventContext"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:">? "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"onEnded"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:");"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    }"})})]})})})})]}),"\n",(0,r.jsxs)(e.p,{children:["When you register a subscription, you receive a ",(0,r.jsx)(e.code,{children:"SubscriptionHandle"}),".\nA ",(0,r.jsx)(e.code,{children:"SubscriptionHandle"})," manages the lifecycle of each subscription you register.\nIn particular, it provides methods to check the status of the subscription and to unsubscribe if necessary.\nBecause each subscription has its own independently managed lifetime,\nclients can dynamically subscribe to different subsets of the database as their application requires."]}),"\n",(0,r.jsx)(e.h3,{id:"example-usage-1",children:"Example Usage"}),"\n",(0,r.jsxs)(o.A,{groupId:"server-language",defaultValue:"rust",children:[(0,r.jsxs)(a.A,{value:"rust",label:"Rust",children:[(0,r.jsxs)(e.p,{children:["Consider a game client that displays shop items and discounts based on a player's level.\nYou subscribe to ",(0,r.jsx)(e.code,{children:"shop_items"})," and ",(0,r.jsx)(e.code,{children:"shop_discounts"})," when a player is at level 5:"]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" DbConnection"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" connect_to_db"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shop_items_subscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"on_applied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"ctx"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle applied state */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"on_error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"error_ctx, error"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle error */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_items WHERE required_level <= 5"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_discounts WHERE required_level <= 5"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ]);"})})]})})}),(0,r.jsx)(e.p,{children:"Later, when the player reaches level 6 and new items become available,\nyou can subscribe to the new queries and unsubscribe from the old ones:"}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" new_shop_items_subscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"on_applied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"ctx"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle applied state */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"on_error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"error_ctx, error"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"|"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle error */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_items WHERE required_level <= 6"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_discounts WHERE required_level <= 6"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ]);"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"if"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shop_items_subscription"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"is_active"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"() {"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    shop_items_subscription"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"unsubscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"        ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"expect"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'"Unsubscribing from shop_items failed"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:");"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})}),(0,r.jsx)(e.p,{children:"All other subscriptions continue to remain in effect."})]}),(0,r.jsxs)(a.A,{value:"csharp",label:"C#",children:[(0,r.jsxs)(e.p,{children:["Consider a game client that displays shop items and discounts based on a player's level.\nYou subscribe to ",(0,r.jsx)(e.code,{children:"shop_items"})," and ",(0,r.jsx)(e.code,{children:"shop_discounts"})," when a player is at level 5:"]}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" ConnectToDB"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shopItemsSubscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"OnApplied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(("}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"ctx"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle applied state */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"OnError"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(("}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"errorCtx"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle error */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_items WHERE required_level <= 5"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_discounts WHERE required_level <= 5"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    });"})})]})})}),(0,r.jsx)(e.p,{children:"Later, when the player reaches level 6 and new items become available,\nyou can subscribe to the new queries and unsubscribe from the old ones:"}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" newShopItemsSubscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"OnApplied"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(("}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"ctx"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle applied state */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"OnError"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(("}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"errorCtx"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:", "}),(0,r.jsx)(e.span,{style:{color:"#FFB86C",fontStyle:"italic"},children:"error"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:") "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"=>"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" { "}),(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"/* handle error */"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" })"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_items WHERE required_level <= 6"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_discounts WHERE required_level <= 6"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    });"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"if"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" (shopItemsSubscription.IsActive)"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    shopItemsSubscription."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Unsubscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})}),(0,r.jsx)(e.p,{children:"All other subscriptions continue to remain in effect."})]})]}),"\n",(0,r.jsx)(e.h2,{id:"best-practices-for-optimizing-server-compute-and-reducing-serialization-overhead",children:"Best Practices for Optimizing Server Compute and Reducing Serialization Overhead"}),"\n",(0,r.jsx)(e.h3,{id:"1-writing-efficient-sql-queries",children:"1. Writing Efficient SQL Queries"}),"\n",(0,r.jsxs)(e.p,{children:["For writing efficient SQL queries, see our ",(0,r.jsx)(e.a,{href:"/sql#best-practices-for-performance-and-scalability",children:"SQL Best Practices Guide"}),"."]}),"\n",(0,r.jsx)(e.h3,{id:"2-group-subscriptions-with-the-same-lifetime-together",children:"2. Group Subscriptions with the Same Lifetime Together"}),"\n",(0,r.jsx)(e.p,{children:"Subscriptions with the same lifetime should be grouped together."}),"\n",(0,r.jsx)(e.p,{children:"For example, you may have certain data that is required for the lifetime of your application,\nbut you may have other data that is only sometimes required by your application."}),"\n",(0,r.jsx)(e.p,{children:"By managing these sets as two independent subscriptions,\nyour application can subscribe and unsubscribe from the latter,\nwithout needlessly unsubscribing and resubscribing to the former."}),"\n",(0,r.jsx)(e.p,{children:"This will improve throughput by reducing the amount of data transferred from the database to your application."}),"\n",(0,r.jsx)(e.h4,{id:"example",children:"Example"}),"\n",(0,r.jsxs)(o.A,{groupId:"server-language",defaultValue:"rust",children:[(0,r.jsx)(a.A,{value:"rust",label:"Rust",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" DbConnection"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" connect_to_db"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Never need to unsubscribe from global subscriptions"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" global_subscriptions "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // Global messages the client should always display"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM announcements"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // A description of rewards for in-game achievements"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM badges"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ]);"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// May unsubscribe to shop_items as player advances"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shop_subscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_items WHERE required_level <= 5"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ]);"})})]})})})}),(0,r.jsx)(a.A,{value:"csharp",label:"C#",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" ConnectToDB"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Never need to unsubscribe from global subscriptions"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" globalSubscriptions "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] {"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // Global messages the client should always display"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM announcements"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // A description of rewards for in-game achievements"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM badges"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    });"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// May unsubscribe to shop_items as player advances"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shopSubscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_items WHERE required_level <= 5"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    });"})})]})})})})]}),"\n",(0,r.jsx)(e.h3,{id:"3-subscribe-before-unsubscribing",children:"3. Subscribe Before Unsubscribing"}),"\n",(0,r.jsx)(e.p,{children:"If you want to update or modify a subscription by dropping it and subscribing to a new set,\nyou should subscribe to the new set before unsubscribing from the old one."}),"\n",(0,r.jsx)(e.p,{children:"This is because SpacetimeDB subscriptions are zero-copy.\nSubscribing to the same query more than once doesn't incur additional processing or serialization overhead.\nLikewise, if a query is subscribed to more than once,\nunsubscribing from it does not result in any server processing or data serializtion."}),"\n",(0,r.jsx)(e.h4,{id:"example-1",children:"Example"}),"\n",(0,r.jsxs)(o.A,{groupId:"server-language",defaultValue:"rust",children:[(0,r.jsx)(a.A,{value:"rust",label:"Rust",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:":"}),(0,r.jsx)(e.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" DbConnection"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" ="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" connect_to_db"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Initial subscription: player at level 5."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shop_subscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // For displaying the price of shop items in the player's currency of choice"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM exchange_rates"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_items WHERE required_level <= 5"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ]);"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// New subscription: player now at level 6, which overlaps with the previous query."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"let"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" new_shop_subscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscription_builder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"(["})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // For displaying the price of shop items in the player's currency of choice"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM exchange_rates"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:'        "SELECT * FROM shop_items WHERE required_level <= 6"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ]);"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Unsubscribe from the old subscription once the new one is active."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"if"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shop_subscription"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"is_active"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"() {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    shop_subscription"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"unsubscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})}),(0,r.jsx)(a.A,{value:"csharp",label:"C#",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:" ConnectToDB"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Initial subscription: player at level 5."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" shopSubscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] {"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // For displaying the price of shop items in the player's currency of choice"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM exchange_rates"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_items WHERE required_level <= 5"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    });"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// New subscription: player now at level 6, which overlaps with the previous query."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"var"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" newShopSubscription "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" conn"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"SubscriptionBuilder"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"()"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    ."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Subscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"("}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"new"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" string"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"[] {"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"        // For displaying the price of shop items in the player's currency of choice"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM exchange_rates"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:","})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'        "'}),(0,r.jsx)(e.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM shop_items WHERE required_level <= 6"}),(0,r.jsx)(e.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    });"})}),"\n",(0,r.jsx)(e.span,{className:"line"}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#6272A4"},children:"// Unsubscribe from the old subscription once the new one is in place."})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"if"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" (shopSubscription.IsActive)"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"    shopSubscription."}),(0,r.jsx)(e.span,{style:{color:"#50FA7B"},children:"Unsubscribe"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"();"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})})]}),"\n",(0,r.jsx)(e.h3,{id:"4-avoid-overlapping-queries",children:"4. Avoid Overlapping Queries"}),"\n",(0,r.jsx)(e.p,{children:"This refers to distinct queries that return intersecting data sets,\nwhich can result in the server processing and serializing the same row multiple times.\nWhile SpacetimeDB can manage this redundancy, it may lead to unnecessary inefficiencies."}),"\n",(0,r.jsx)(e.p,{children:"Consider the following two queries:"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"SELECT"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" *"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" FROM"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" User"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"SELECT"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" *"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" FROM"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" User "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"WHERE"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" id "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"="}),(0,r.jsx)(e.span,{style:{color:"#BD93F9"},children:" 5"})]})]})})}),"\n",(0,r.jsxs)(e.p,{children:["If ",(0,r.jsx)(e.code,{children:"User.id"})," is a unique or primary key column,\nthe cost of subscribing to both queries is minimal.\nThis is because the server will use an index when processing the 2nd query,\nand it will only serialize a single row for the 2nd query."]}),"\n",(0,r.jsx)(e.p,{children:"In contrast, consider these two queries:"}),"\n",(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(e.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,r.jsxs)(e.code,{children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"SELECT"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" *"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" FROM"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" User"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"SELECT"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" *"}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:" FROM"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" User "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"WHERE"}),(0,r.jsx)(e.span,{style:{color:"#F8F8F2"},children:" id "}),(0,r.jsx)(e.span,{style:{color:"#FF79C6"},children:"!="}),(0,r.jsx)(e.span,{style:{color:"#BD93F9"},children:" 5"})]})]})})}),"\n",(0,r.jsxs)(e.p,{children:["The server must now process each row of the ",(0,r.jsx)(e.code,{children:"User"})," table twice,\nsince the 2nd query cannot be processed using an index.\nIt must also serialize all but one row of the ",(0,r.jsx)(e.code,{children:"User"})," table twice,\ndue to the significant overlap between the two queries."]}),"\n",(0,r.jsx)(e.p,{children:"By following these best practices, you can optimize your data replication strategy and ensure your application remains efficient and responsive."})]})}function h(s={}){const{wrapper:e}={...(0,c.R)(),...s.components};return e?(0,r.jsx)(e,{...s,children:(0,r.jsx)(p,{...s})}):p(s)}},6119:(s,e,l)=>{l.d(e,{R:()=>o,x:()=>a});var n=l(3303);const r={},c=n.createContext(r);function o(s){const e=n.useContext(c);return n.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function a(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(r):s.components||r:o(s.components),n.createElement(c.Provider,{value:e},s.children)}},8720:(s,e,l)=>{l.d(e,{A:()=>o});l(3303);var n=l(3372);const r={tabItem:"tabItem_sydm"};var c=l(7711);function o({children:s,hidden:e,className:l}){return(0,c.jsx)("div",{role:"tabpanel",className:(0,n.A)(r.tabItem,l),hidden:e,children:s})}}}]);