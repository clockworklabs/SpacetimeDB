"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4698],{623:(l,s,e)=>{e.d(s,{A:()=>f});var n=e(3303),c=e(3372),r=e(9607),a=e(2592),i=e(8368),o=e(1711),t=e(4541),d=e(4930),F=e(6022);function p(l){return n.Children.toArray(l).filter(l=>"\n"!==l).map(l=>{if(!l||(0,n.isValidElement)(l)&&function(l){const{props:s}=l;return!!s&&"object"==typeof s&&"value"in s}(l))return l;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof l.type?l.type:l.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(l){const{values:s,children:e}=l;return(0,n.useMemo)(()=>{const l=s??function(l){return p(l).map(({props:{value:l,label:s,attributes:e,default:n}})=>({value:l,label:s,attributes:e,default:n}))}(e);return function(l){const s=(0,d.XI)(l,(l,s)=>l.value===s.value);if(s.length>0)throw new Error(`Docusaurus error: Duplicate values "${s.map(l=>l.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(l),l},[s,e])}function x({value:l,tabValues:s}){return s.some(s=>s.value===l)}function j({queryString:l=!1,groupId:s}){const e=(0,i.W6)(),c=function({queryString:l=!1,groupId:s}){if("string"==typeof l)return l;if(!1===l)return null;if(!0===l&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:l,groupId:s});return[(0,t.aZ)(c),(0,n.useCallback)(l=>{if(!c)return;const s=new URLSearchParams(e.location.search);s.set(c,l),e.replace({...e.location,search:s.toString()})},[c,e])]}function y(l){const{defaultValue:s,queryString:e=!1,groupId:c}=l,r=h(l),[a,i]=(0,n.useState)(()=>function({defaultValue:l,tabValues:s}){if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(l){if(!x({value:l,tabValues:s}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${l}" but none of its children has the corresponding value. Available values are: ${s.map(l=>l.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return l}const e=s.find(l=>l.default)??s[0];if(!e)throw new Error("Unexpected error: 0 tabValues");return e.value}({defaultValue:s,tabValues:r})),[t,d]=j({queryString:e,groupId:c}),[p,y]=function({groupId:l}){const s=function(l){return l?`docusaurus.tab.${l}`:null}(l),[e,c]=(0,F.Dv)(s);return[e,(0,n.useCallback)(l=>{s&&c.set(l)},[s,c])]}({groupId:c}),u=(()=>{const l=t??p;return x({value:l,tabValues:r})?l:null})();(0,o.A)(()=>{u&&i(u)},[u]);return{selectedValue:a,selectValue:(0,n.useCallback)(l=>{if(!x({value:l,tabValues:r}))throw new Error(`Can't select invalid tab value=${l}`);i(l),d(l),y(l)},[d,y,r]),tabValues:r}}var u=e(93);const m={tabList:"tabList_MbSD",tabItem:"tabItem_Ssy3"};var C=e(7711);function b({className:l,block:s,selectedValue:e,selectValue:n,tabValues:r}){const i=[],{blockElementScrollPositionUntilNextRender:o}=(0,a.a_)(),t=l=>{const s=l.currentTarget,c=i.indexOf(s),a=r[c].value;a!==e&&(o(s),n(a))},d=l=>{let s=null;switch(l.key){case"Enter":t(l);break;case"ArrowRight":{const e=i.indexOf(l.currentTarget)+1;s=i[e]??i[0];break}case"ArrowLeft":{const e=i.indexOf(l.currentTarget)-1;s=i[e]??i[i.length-1];break}}s?.focus()};return(0,C.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,c.A)("tabs",{"tabs--block":s},l),children:r.map(({value:l,label:s,attributes:n})=>(0,C.jsx)("li",{role:"tab",tabIndex:e===l?0:-1,"aria-selected":e===l,ref:l=>{i.push(l)},onKeyDown:d,onClick:t,...n,className:(0,c.A)("tabs__item",m.tabItem,n?.className,{"tabs__item--active":e===l}),children:s??l},l))})}function N({lazy:l,children:s,selectedValue:e}){const r=(Array.isArray(s)?s:[s]).filter(Boolean);if(l){const l=r.find(l=>l.props.value===e);return l?(0,n.cloneElement)(l,{className:(0,c.A)("margin-top--md",l.props.className)}):null}return(0,C.jsx)("div",{className:"margin-top--md",children:r.map((l,s)=>(0,n.cloneElement)(l,{key:s,hidden:l.props.value!==e}))})}function E(l){const s=y(l);return(0,C.jsxs)("div",{className:(0,c.A)(r.G.tabs.container,"tabs-container",m.tabList),children:[(0,C.jsx)(b,{...s,...l}),(0,C.jsx)(N,{...s,...l})]})}function f(l){const s=(0,u.A)();return(0,C.jsx)(E,{...l,children:p(l.children)},String(s))}},6119:(l,s,e)=>{e.d(s,{R:()=>a,x:()=>i});var n=e(3303);const c={},r=n.createContext(c);function a(l){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof l?l(s):{...s,...l}},[s,l])}function i(l){let s;return s=l.disableParentContext?"function"==typeof l.components?l.components(c):l.components||c:a(l.components),n.createElement(r.Provider,{value:s},l.children)}},7668:(l,s,e)=>{e.r(s),e.d(s,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>F});const n=JSON.parse('{"id":"Row Level Security/index","title":"Row Level Security","description":"Row Level Security (RLS) allows module authors to restrict which rows of a public table each client can access.","source":"@site/docs/10-Row Level Security/index.md","sourceDirName":"10-Row Level Security","slug":"/rls","permalink":"/rls","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Row Level Security","slug":"/rls"},"sidebar":"sidebar","previous":{"title":"Subscription Semantics","permalink":"/subscriptions/semantics"},"next":{"title":"Incremental Migrations","permalink":"/how-to/incremental-migrations"}}');var c=e(7711),r=e(6119),a=e(623),i=e(8720);const o={title:"Row Level Security",slug:"/rls"},t="Row Level Security (RLS)",d={},F=[{value:"Enabling RLS",id:"enabling-rls",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"<code>:sender</code>",id:"sender",level:3},{value:"Semantic Constraints",id:"semantic-constraints",level:3},{value:"Multiple Rules Per Table",id:"multiple-rules-per-table",level:3},{value:"Example",id:"example",level:4},{value:"Recursive Application",id:"recursive-application",level:3},{value:"Example",id:"example-1",level:4},{value:"Example: Self-Join",id:"example-self-join",level:4},{value:"Example: Recursive Rules",id:"example-recursive-rules",level:4},{value:"Usage in Subscriptions",id:"usage-in-subscriptions",level:2},{value:"Best Practices",id:"best-practices",level:2}];function p(l){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",...(0,r.R)(),...l.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.header,{children:(0,c.jsx)(s.h1,{id:"row-level-security-rls",children:"Row Level Security (RLS)"})}),"\n",(0,c.jsx)(s.p,{children:"Row Level Security (RLS) allows module authors to restrict which rows of a public table each client can access.\nThese access rules are expressed in SQL and evaluated automatically for queries and subscriptions."}),"\n",(0,c.jsx)(s.h2,{id:"enabling-rls",children:"Enabling RLS"}),"\n",(0,c.jsxs)(s.p,{children:["RLS is currently ",(0,c.jsx)(s.strong,{children:"experimental"})," and must be explicitly enabled in your module."]}),"\n",(0,c.jsxs)(a.A,{groupId:"server-language",defaultValue:"rust",children:[(0,c.jsxs)(i.A,{value:"rust",label:"Rust",children:[(0,c.jsxs)(s.p,{children:["To enable RLS, activate the ",(0,c.jsx)(s.code,{children:"unstable"})," feature in your project's ",(0,c.jsx)(s.code,{children:"Cargo.toml"}),":"]}),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsx)(s.code,{children:(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:"spacetimedb"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" { "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:"version"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:' "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"..."}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:", "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:"features"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ["}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"unstable"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"] }"})]})})})})]}),(0,c.jsxs)(i.A,{value:"csharp",label:"C#",children:[(0,c.jsx)(s.p,{children:"To enable RLS, include the following preprocessor directive at the top of your module files:"}),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsx)(s.code,{children:(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"#pragma"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" warning"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" disable"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" STDB_UNSTABLE"})]})})})})]})]}),"\n",(0,c.jsx)(s.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,c.jsxs)(a.A,{groupId:"server-language",defaultValue:"rust",children:[(0,c.jsxs)(i.A,{value:"rust",label:"Rust",children:[(0,c.jsxs)(s.p,{children:["RLS rules are expressed in SQL and declared as constants of type ",(0,c.jsx)(s.code,{children:"Filter"}),"."]}),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"use"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" spacetimedb"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{client_visibility_filter, "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"};"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// A client can only see their account"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" ACCOUNT_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT * FROM account WHERE account.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})})]})})})]}),(0,c.jsxs)(i.A,{value:"csharp",label:"C#",children:[(0,c.jsxs)(s.p,{children:["RLS rules are expressed in SQL and declared as public static readonly fields of type ",(0,c.jsx)(s.code,{children:"Filter"}),"."]}),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"using"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"#pragma"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" warning"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" disable"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" STDB_UNSTABLE"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" partial"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" class"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:" Module"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// A client can only see their account."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM account WHERE account.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})]})]}),"\n",(0,c.jsx)(s.p,{children:"A module will fail to publish if any of its RLS rules are invalid or malformed."}),"\n",(0,c.jsx)(s.h3,{id:"sender",children:(0,c.jsx)(s.code,{children:":sender"})}),"\n",(0,c.jsxs)(s.p,{children:["You can use the special ",(0,c.jsx)(s.code,{children:":sender"})," parameter in your rules for user specific access control.\nThis parameter is automatically bound to the requesting client's ",(0,c.jsx)(s.a,{href:"/#identity",children:"Identity"}),"."]}),"\n",(0,c.jsx)(s.p,{children:"Note that module owners have unrestricted access to all tables regardless of RLS."}),"\n",(0,c.jsx)(s.h3,{id:"semantic-constraints",children:"Semantic Constraints"}),"\n",(0,c.jsxs)(s.p,{children:["RLS rules are similar to subscriptions in that logically they act as filters on a particular table.\nAlso like subscriptions, arbitrary column projections are ",(0,c.jsx)(s.strong,{children:"not"})," allowed.\nJoins ",(0,c.jsx)(s.strong,{children:"are"})," allowed, but each rule must return rows from one and only one table."]}),"\n",(0,c.jsx)(s.h3,{id:"multiple-rules-per-table",children:"Multiple Rules Per Table"}),"\n",(0,c.jsxs)(s.p,{children:["Multiple rules may be declared for the same table and will be evaluated as a logical ",(0,c.jsx)(s.code,{children:"OR"}),".\nThis means clients will be able to see to any row that matches at least one of the rules."]}),"\n",(0,c.jsx)(s.h4,{id:"example",children:"Example"}),"\n",(0,c.jsxs)(a.A,{groupId:"server-language",defaultValue:"rust",children:[(0,c.jsx)(i.A,{value:"rust",label:"Rust",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"use"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" spacetimedb"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{client_visibility_filter, "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"};"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// A client can only see their account"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" ACCOUNT_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT * FROM account WHERE account.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// An admin can see all accounts"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" ACCOUNT_FILTER_FOR_ADMINS"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})})]})})})}),(0,c.jsx)(i.A,{value:"csharp",label:"C#",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"using"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"#pragma"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" warning"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" disable"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" STDB_UNSTABLE"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" partial"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" class"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:" Module"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// A client can only see their account."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM account WHERE account.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// An admin can see all accounts."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER_FOR_ADMINS "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})})]}),"\n",(0,c.jsx)(s.h3,{id:"recursive-application",children:"Recursive Application"}),"\n",(0,c.jsx)(s.p,{children:"RLS rules can reference other tables with RLS rules, and they will be applied recursively.\nThis ensures that data is never leaked through indirect access patterns."}),"\n",(0,c.jsx)(s.h4,{id:"example-1",children:"Example"}),"\n",(0,c.jsxs)(a.A,{groupId:"server-language",defaultValue:"rust",children:[(0,c.jsx)(i.A,{value:"rust",label:"Rust",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"use"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" spacetimedb"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{client_visibility_filter, "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"};"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// A client can only see their account"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" ACCOUNT_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT * FROM account WHERE account.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// An admin can see all accounts"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" ACCOUNT_FILTER_FOR_ADMINS"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// Explicitly filtering by client identity in this rule is not necessary,"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// since the above RLS rules on `account` will be applied automatically."})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// Hence a client can only see their player, but an admin can see all players."})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" PLAYER_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT p.* FROM account a JOIN player p ON a.id = p.id"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})})]})})})}),(0,c.jsx)(i.A,{value:"csharp",label:"C#",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"using"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" partial"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" class"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:" Module"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// A client can only see their account."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT * FROM account WHERE account.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// An admin can see all accounts."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER_FOR_ADMINS "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT account.* FROM account JOIN admin WHERE admin.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// Explicitly filtering by client identity in this rule is not necessary,"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// since the above RLS rules on `account` will be applied automatically."})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// Hence a client can only see their player, but an admin can see all players."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" PLAYER_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT p.* FROM account a JOIN player p ON a.id = p.id"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})})]}),"\n",(0,c.jsx)(s.p,{children:"And while self-joins are allowed, in general RLS rules cannot be self-referential,\nas this would result in infinite recursion."}),"\n",(0,c.jsx)(s.h4,{id:"example-self-join",children:"Example: Self-Join"}),"\n",(0,c.jsxs)(a.A,{groupId:"server-language",defaultValue:"rust",children:[(0,c.jsx)(i.A,{value:"rust",label:"Rust",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"use"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" spacetimedb"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{client_visibility_filter, "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"};"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// A client can only see players on their same level"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" PLAYER_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"    SELECT q.*"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"    FROM account a"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"    JOIN player p ON a.id = p.id"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"    JOIN player q on p.level = q.level"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"    WHERE a.identity = :sender"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'"'}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})]})]})})})}),(0,c.jsx)(i.A,{value:"csharp",label:"C#",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"using"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" partial"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" class"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:" Module"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// A client can only see players on their same level."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" PLAYER_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'@"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"        SELECT q.*"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"        FROM account a"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"        JOIN player p ON a.id = p.id"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"        JOIN player q on p.level = q.level"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"        WHERE a.identity = :sender"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'    "'}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})})]}),"\n",(0,c.jsx)(s.h4,{id:"example-recursive-rules",children:"Example: Recursive Rules"}),"\n",(0,c.jsx)(s.p,{children:"This module will fail to publish because each rule depends on the other one."}),"\n",(0,c.jsxs)(a.A,{groupId:"server-language",defaultValue:"rust",children:[(0,c.jsx)(i.A,{value:"rust",label:"Rust",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"use"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" spacetimedb"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{client_visibility_filter, "}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"};"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// An account must have a corresponding player"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" ACCOUNT_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT a.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"/// A player must have a corresponding account"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"#[client_visibility_filter]"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"const"}),(0,c.jsx)(s.span,{style:{color:"#BD93F9"},children:" PLAYER_FILTER"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:":"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" ="}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"::"}),(0,c.jsx)(s.span,{style:{color:"#50FA7B"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:'    "SELECT p.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender"'})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:");"})})]})})})}),(0,c.jsx)(i.A,{value:"csharp",label:"C#",children:(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.pre,{className:"shiki spacetime-dark",style:{backgroundColor:"var(--clockworklabs-code-background-color)",color:"#F8F8F2"},tabIndex:"0",children:(0,c.jsxs)(s.code,{children:[(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"using"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:";"})]}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" partial"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" class"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD"},children:" Module"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"{"})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// An account must have a corresponding player."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT a.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line"}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"<"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// A player must have a corresponding account."})}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#6272A4"},children:"    /// "}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"</"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"summary"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:">"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    ["}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"SpacetimeDB"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"ClientVisibilityFilter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"]"})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"    public"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" static"}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" readonly"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:" ACCOUNT_FILTER "}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:"="}),(0,c.jsx)(s.span,{style:{color:"#FF79C6"},children:" new"}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:" Filter"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"."}),(0,c.jsx)(s.span,{style:{color:"#8BE9FD",fontStyle:"italic"},children:"Sql"}),(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"("})]}),"\n",(0,c.jsxs)(s.span,{className:"line",children:[(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'        "'}),(0,c.jsx)(s.span,{style:{color:"#F1FA8C"},children:"SELECT p.* FROM account a JOIN player p ON a.id = p.id WHERE a.identity = :sender"}),(0,c.jsx)(s.span,{style:{color:"#E9F284"},children:'"'})]}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"    );"})}),"\n",(0,c.jsx)(s.span,{className:"line",children:(0,c.jsx)(s.span,{style:{color:"#F8F8F2"},children:"}"})})]})})})})]}),"\n",(0,c.jsx)(s.h2,{id:"usage-in-subscriptions",children:"Usage in Subscriptions"}),"\n",(0,c.jsx)(s.p,{children:"RLS rules automatically apply to subscriptions so that if a client subscribes to a table with RLS filters,\nthe subscription will only return rows that the client is allowed to see."}),"\n",(0,c.jsxs)(s.p,{children:["While the contraints and limitations outlined in the ",(0,c.jsx)(s.a,{href:"/sql#subscriptions",children:"reference docs"})," do not apply to RLS rules,\nthey do apply to the subscriptions that use them.\nFor example, it is valid for an RLS rule to have more joins than are supported by subscriptions.\nHowever a client will not be able to subscribe to the table for which that rule is defined."]}),"\n",(0,c.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsxs)(s.li,{children:["Use ",(0,c.jsx)(s.code,{children:":sender"})," for client specific filtering."]}),"\n",(0,c.jsxs)(s.li,{children:["Follow the ",(0,c.jsx)(s.a,{href:"/sql#best-practices-for-performance-and-scalability",children:"SQL best practices"})," for optimizing your RLS rules."]}),"\n"]})]})}function h(l={}){const{wrapper:s}={...(0,r.R)(),...l.components};return s?(0,c.jsx)(s,{...l,children:(0,c.jsx)(p,{...l})}):p(l)}},8720:(l,s,e)=>{e.d(s,{A:()=>a});e(3303);var n=e(3372);const c={tabItem:"tabItem_sydm"};var r=e(7711);function a({children:l,hidden:s,className:e}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,n.A)(c.tabItem,e),hidden:s,children:l})}}}]);