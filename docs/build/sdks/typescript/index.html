<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Client SDK Languages/Typescript-Reference" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">TypeScript Reference | SpacetimeDB docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.spacetimedb.com/sdks/typescript"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="TypeScript Reference | SpacetimeDB docs"><meta data-rh="true" name="description" content="The SpacetimeDB client SDK for TypeScript contains all the tools you need to build clients for SpacetimeDB modules using Typescript, either in the browser or with NodeJS."><meta data-rh="true" property="og:description" content="The SpacetimeDB client SDK for TypeScript contains all the tools you need to build clients for SpacetimeDB modules using Typescript, either in the browser or with NodeJS."><link data-rh="true" rel="icon" href="/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.spacetimedb.com/sdks/typescript"><link data-rh="true" rel="alternate" href="https://docs.spacetimedb.com/sdks/typescript" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spacetimedb.com/sdks/typescript" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QBC7Z9KXS2-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"TypeScript Reference","item":"https://docs.spacetimedb.com/sdks/typescript"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="SpacetimeDB docs" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.0cb9f7a7.css">
<script src="/assets/js/runtime~main.d71df0f5.js" defer="defer"></script>
<script src="/assets/js/main.31d95d83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="https://spacetimedb.com/images/brand.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_6jFv" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="https://spacetimedb.com/images/brand.png" alt="SpacetimeDB Logo" class="themedComponent_rvet themedComponent--light_mbAJ"><img src="https://spacetimedb.com/images/brand.png" alt="SpacetimeDB Logo" class="themedComponent_rvet themedComponent--dark_Ncy6"></div></a><div class="navbarSearchContainer_AesG"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://spacetimedb.com/install" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Install</a><a href="https://spacetimedb.com/pricing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a><a href="https://spacetimedb.com/maincloud" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Maincloud</a><a href="https://spacetimedb.com/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://spacetimedb.com/community" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Community</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_hV_y"><div class="docsWrapper_f07g"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_MJiz" type="button"></button><div class="docRoot_Gd2s"><aside class="theme-doc-sidebar-container docSidebarContainer_fSpF"><div class="sidebarViewport_YElg"><div class="sidebar_kjg4"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_AG0n"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/"><span title="Intro" class="categoryLinkLabel_EDYQ">Intro</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/deploying/maincloud"><span title="Deploying" class="categoryLinkLabel_EDYQ">Deploying</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/unity"><span title="Unity tutorial" class="categoryLinkLabel_EDYQ">Unity tutorial</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/unreal"><span title="Unreal Tutorial" class="categoryLinkLabel_EDYQ">Unreal Tutorial</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cli-reference"><span title="CLI Reference" class="categoryLinkLabel_EDYQ">CLI Reference</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/modules"><span title="Server Module Languages" class="categoryLinkLabel_EDYQ">Server Module Languages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/sdks"><span title="Client SDK Languages" class="categoryLinkLabel_EDYQ">Client SDK Languages</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sdks"><span title="Overview" class="linkLabel_dpMB">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sdks/c-sharp/quickstart"><span title="C# Quickstart" class="linkLabel_dpMB">C# Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sdks/c-sharp"><span title="C# Reference" class="linkLabel_dpMB">C# Reference</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sdks/rust/quickstart"><span title="Rust Quickstart" class="linkLabel_dpMB">Rust Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sdks/rust"><span title="Rust Reference" class="linkLabel_dpMB">Rust Reference</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sdks/typescript/quickstart"><span title="TypeScript Quickstart" class="linkLabel_dpMB">TypeScript Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sdks/typescript"><span title="TypeScript Reference" class="linkLabel_dpMB">TypeScript Reference</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/sql"><span title="SQL" class="categoryLinkLabel_EDYQ">SQL</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/subscriptions"><span title="Subscriptions" class="categoryLinkLabel_EDYQ">Subscriptions</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rls"><span title="Row Level Security" class="linkLabel_dpMB">Row Level Security</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/how-to/incremental-migrations"><span title="How-To" class="categoryLinkLabel_EDYQ">How-To</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/spacetimeauth"><span title="SpacetimeAuth" class="categoryLinkLabel_EDYQ">SpacetimeAuth</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/http/authorization"><span title="HTTP API" class="categoryLinkLabel_EDYQ">HTTP API</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_ggI5 menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/webassembly-abi"><span title="Internals" class="categoryLinkLabel_EDYQ">Internals</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/appendix"><span title="Appendix" class="linkLabel_dpMB">Appendix</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_dkUT"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_w2oE"><div class="docItemContainer_f71m"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xsLZ" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_oyay"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Client SDK Languages</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">TypeScript Reference</span></li></ul></nav><div class="tocCollapsible_dqme theme-doc-toc-mobile tocMobile_Z34P"><button type="button" class="clean-btn tocCollapsibleButton_QMSE">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>The SpacetimeDB Typescript client SDK</h1></header>
<p>The SpacetimeDB client SDK for TypeScript contains all the tools you need to build clients for SpacetimeDB modules using Typescript, either in the browser or with NodeJS.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#project-setup">Project setup</a></td><td>Configure your TypeScript project to use the SpacetimeDB TypeScript client SDK.</td></tr><tr><td><a href="#generate-module-bindings">Generate module bindings</a></td><td>Use the SpacetimeDB CLI to generate module-specific types and interfaces.</td></tr><tr><td><a href="#type-dbconnection"><code>DbConnection</code> type</a></td><td>A connection to a remote database.</td></tr><tr><td><a href="#interface-dbcontext"><code>DbContext</code> interface</a></td><td>Methods for interacting with the remote database. Implemented by <a href="#type-dbconnection"><code>DbConnection</code></a> and various event context types.</td></tr><tr><td><a href="#type-eventcontext"><code>EventContext</code> type</a></td><td><a href="#interface-dbcontext"><code>DbContext</code></a> available in <a href="#callback-oninsert">row callbacks</a>.</td></tr><tr><td><a href="#type-reducereventcontext"><code>ReducerEventContext</code> type</a></td><td><a href="#interface-dbcontext"><code>DbContext</code></a> available in <a href="#observe-and-invoke-reducers">reducer callbacks</a>.</td></tr><tr><td><a href="#type-subscriptioneventcontext"><code>SubscriptionEventContext</code> type</a></td><td><a href="#interface-dbcontext"><code>DbContext</code></a> available in <a href="#subscribe-to-queries">subscription-related callbacks</a>.</td></tr><tr><td><a href="#type-errorcontext"><code>ErrorContext</code> type</a></td><td><a href="#interface-dbcontext"><code>DbContext</code></a> available in error-related callbacks.</td></tr><tr><td><a href="#access-the-client-cache">Access the client cache</a></td><td>Make local queries against subscribed rows, and register <a href="#callback-oninsert">row callbacks</a> to run when subscribed rows change.</td></tr><tr><td><a href="#observe-and-invoke-reducers">Observe and invoke reducers</a></td><td>Send requests to the database to run reducers, and register callbacks to run when notified of reducers.</td></tr><tr><td><a href="#identify-a-client">Identify a client</a></td><td>Types for identifying users and client connections.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="project-setup">Project setup<a href="#project-setup" class="hash-link" aria-label="Direct link to Project setup" title="Direct link to Project setup" translate="no">​</a></h2>
<p>First, create a new client project, and add the following to your <code>tsconfig.json</code> file:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#8BE9FE">  &quot;</span><span style="color:#8BE9FD">compilerOptions</span><span style="color:#8BE9FE">&quot;</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">    //You can use any target higher than this one</span></span>
<span class="line"><span style="color:#6272A4">    //https://www.typescriptlang.org/tsconfig#target</span></span>
<span class="line"><span style="color:#8BE9FE">    &quot;</span><span style="color:#8BE9FD">target</span><span style="color:#8BE9FE">&quot;</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> &quot;</span><span style="color:#F1FA8C">es2015</span><span style="color:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Then add the SpacetimeDB SDK to your dependencies:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#8BE9FD">cd</span><span style="color:#F1FA8C"> client</span></span>
<span class="line"><span style="color:#50FA7B">npm</span><span style="color:#F1FA8C"> install</span><span style="color:#F1FA8C"> spacetimedb</span></span></code></pre>
<blockquote>
<p>WARNING! The <code>@clockworklabs/spacetimedb-sdk</code> package has been deprecated in favor of the <code>spacetimedb</code> package as of SpacetimeDB version 1.4.0. If you are using the old SDK package, you will need to switch to <code>spacetimedb</code>. You will also need a SpacetimeDB CLI version of 1.4.0+ to generate bindings for the new <code>spacetimedb</code> package.</p>
</blockquote>
<p>You should have this folder layout starting from the root of your project:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">quickstart-chat</span></span>
<span class="line"><span style="color:#50FA7B">├──</span><span style="color:#F1FA8C"> client</span></span>
<span class="line"><span style="color:#50FA7B">│</span><span style="color:#F1FA8C">   ├──</span><span style="color:#F1FA8C"> node_modules</span></span>
<span class="line"><span style="color:#50FA7B">│</span><span style="color:#F1FA8C">   ├──</span><span style="color:#F1FA8C"> public</span></span>
<span class="line"><span style="color:#50FA7B">│</span><span style="color:#F1FA8C">   └──</span><span style="color:#F1FA8C"> src</span></span>
<span class="line"><span style="color:#50FA7B">└──</span><span style="color:#F1FA8C"> server</span></span>
<span class="line"><span style="color:#50FA7B">    └──</span><span style="color:#F1FA8C"> src</span></span></code></pre>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="tip-for-utilitiesscripts">Tip for utilities/scripts<a href="#tip-for-utilitiesscripts" class="hash-link" aria-label="Direct link to Tip for utilities/scripts" title="Direct link to Tip for utilities/scripts" translate="no">​</a></h3>
<p>If want to create a quick script to test your module bindings from the command line, you can use <a href="https://www.npmjs.com/package/tsx" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/tsx</a> to execute TypeScript files.</p>
<p>Then you create a <code>script.ts</code> file and add the imports, code and execute with:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">npx</span><span style="color:#F1FA8C"> tsx</span><span style="color:#F1FA8C"> src/script.ts</span></span></code></pre>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="generate-module-bindings">Generate module bindings<a href="#generate-module-bindings" class="hash-link" aria-label="Direct link to Generate module bindings" title="Direct link to Generate module bindings" translate="no">​</a></h2>
<p>Each SpacetimeDB client depends on some bindings specific to your module. Create a <code>module_bindings</code> directory in your project&#x27;s <code>src</code> directory and generate the Typescript interface files using the Spacetime CLI. From your project directory, run:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#50FA7B">mkdir</span><span style="color:#BD93F9"> -p</span><span style="color:#F1FA8C"> client/src/module_bindings</span></span>
<span class="line"><span style="color:#50FA7B">spacetime</span><span style="color:#F1FA8C"> generate</span><span style="color:#BD93F9"> --lang</span><span style="color:#F1FA8C"> typescript</span><span style="color:#FF79C6"> \</span></span>
<span class="line"><span style="color:#BD93F9">    --out-dir</span><span style="color:#F1FA8C"> client/src/module_bindings</span><span style="color:#FF79C6"> \</span></span>
<span class="line"><span style="color:#BD93F9">    --project-path</span><span style="color:#F1FA8C"> PATH-TO-MODULE-DIRECTORY</span></span></code></pre>
<p>Import the <code>module_bindings</code> in your client&#x27;s <em>main</em> file:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">import</span><span style="color:#BD93F9"> *</span><span style="color:#FF79C6"> as</span><span style="color:#F8F8F2"> moduleBindings </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> &#x27;</span><span style="color:#F1FA8C">./module_bindings/index</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span></code></pre>
<p>You may also need to import some definitions from the SDK library:</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">import</span><span style="color:#F8F8F2"> { Identity, ConnectionId, Event, ReducerEvent } </span><span style="color:#FF79C6">from</span><span style="color:#E9F284"> &#x27;</span><span style="color:#F1FA8C">spacetimedb</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span></code></pre>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="type-dbconnection">Type <code>DbConnection</code><a href="#type-dbconnection" class="hash-link" aria-label="Direct link to type-dbconnection" title="Direct link to type-dbconnection" translate="no">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">DbConnection;</span></span></code></pre>
<p>A connection to a remote database is represented by the <code>DbConnection</code> type. This type is generated per-module, and contains information about the types, tables and reducers defined by your module.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#connect-to-a-database">Connect to a database</a></td><td>Construct a <code>DbConnection</code>.</td></tr><tr><td><a href="#access-tables-and-reducers">Access tables and reducers</a></td><td>Access subscribed rows in the client cache, request reducer invocations, and register callbacks.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="connect-to-a-database">Connect to a database<a href="#connect-to-a-database" class="hash-link" aria-label="Direct link to Connect to a database" title="Direct link to Connect to a database" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnection</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#FF79C6"> static</span><span style="color:#50FA7B"> builder</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Construct a <code>DbConnection</code> by calling <code>DbConnection.builder()</code> and chaining configuration methods, then calling <code>.build()</code>. You must at least specify <code>withUri</code>, to supply the URI of the SpacetimeDB to which you published your module, and <code>withModuleName</code>, to supply the human-readable SpacetimeDB domain name or the raw <code>Identity</code> which identifies the database.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#method-withuri"><code>withUri</code> method</a></td><td>Set the URI of the SpacetimeDB instance which hosts the remote database.</td></tr><tr><td><a href="#method-withmodulename"><code>withModuleName</code> method</a></td><td>Set the name or <code>Identity</code> of the remote database.</td></tr><tr><td><a href="#callback-onconnect"><code>onConnect</code> callback</a></td><td>Register a callback to run when the connection is successfully established.</td></tr><tr><td><a href="#callback-onconnecterror"><code>onConnectError</code> callback</a></td><td>Register a callback to run if the connection is rejected or the host is unreachable.</td></tr><tr><td><a href="#callback-ondisconnect"><code>onDisconnect</code> callback</a></td><td>Register a callback to run when the connection ends.</td></tr><tr><td><a href="#method-withtoken"><code>withToken</code> method</a></td><td>Supply a token to authenticate with the remote database.</td></tr><tr><td><a href="#method-build"><code>build</code> method</a></td><td>Finalize configuration and connect.</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="method-withuri">Method <code>withUri</code><a href="#method-withuri" class="hash-link" aria-label="Direct link to method-withuri" title="Direct link to method-withuri" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> withUri</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">uri</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Configure the URI of the SpacetimeDB instance or cluster which hosts the remote database.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="method-withmodulename">Method <code>withModuleName</code><a href="#method-withmodulename" class="hash-link" aria-label="Direct link to method-withmodulename" title="Direct link to method-withmodulename" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> withModuleName</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">name_or_identity</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Configure the SpacetimeDB domain name or hex string encoded <code>Identity</code> of the remote database which identifies it within the SpacetimeDB instance or cluster.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="callback-onconnect">Callback <code>onConnect</code><a href="#callback-onconnect" class="hash-link" aria-label="Direct link to callback-onconnect" title="Direct link to callback-onconnect" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onConnect</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnection</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">identity</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Identity</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">token</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Chain a call to <code>.onConnect(callback)</code> to your builder to register a callback to run when your new <code>DbConnection</code> successfully initiates its connection to the remote database. The callback accepts three arguments: a reference to the <code>DbConnection</code>, the <code>Identity</code> by which SpacetimeDB identifies this connection, and a private access token which can be saved and later passed to <a href="#method-withtoken"><code>withToken</code></a> to authenticate the same user in future connections.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="callback-onconnecterror">Callback <code>onConnectError</code><a href="#callback-onconnecterror" class="hash-link" aria-label="Direct link to callback-onconnecterror" title="Direct link to callback-onconnecterror" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onConnectError</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ErrorContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">error</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Error</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Chain a call to <code>.onConnectError(callback)</code> to your builder to register a callback to run when your connection fails.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="callback-ondisconnect">Callback <code>onDisconnect</code><a href="#callback-ondisconnect" class="hash-link" aria-label="Direct link to callback-ondisconnect" title="Direct link to callback-ondisconnect" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onDisconnect</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ErrorContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">error</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Error</span><span style="color:#FF79C6"> |</span><span style="color:#8BE9FD;font-style:italic"> null</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Chain a call to <code>.onDisconnect(callback)</code> to your builder to register a callback to run when your <code>DbConnection</code> disconnects from the remote database, either as a result of a call to <a href="#method-disconnect"><code>disconnect</code></a> or due to an error.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="method-withtoken">Method <code>withToken</code><a href="#method-withtoken" class="hash-link" aria-label="Direct link to method-withtoken" title="Direct link to method-withtoken" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> withToken</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">token</span><span style="color:#FF79C6">?:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnectionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Chain a call to <code>.withToken(token)</code> to your builder to provide an OpenID Connect compliant JSON Web Token to authenticate with, or to explicitly select an anonymous connection. If this method is not called or <code>null</code> is passed, SpacetimeDB will generate a new <code>Identity</code> and sign a new private access token for the connection.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="method-build">Method <code>build</code><a href="#method-build" class="hash-link" aria-label="Direct link to method-build" title="Direct link to method-build" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnectionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> build</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbConnection</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>After configuring the connection and registering callbacks, attempt to open the connection.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="access-tables-and-reducers">Access tables and reducers<a href="#access-tables-and-reducers" class="hash-link" aria-label="Direct link to Access tables and reducers" title="Direct link to Access tables and reducers" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="field-db">Field <code>db</code><a href="#field-db" class="hash-link" aria-label="Direct link to field-db" title="Direct link to field-db" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnection</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> db</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteTables</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>db</code> field of the <code>DbConnection</code> provides access to the subscribed view of the remote database&#x27;s tables. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="field-reducers">Field <code>reducers</code><a href="#field-reducers" class="hash-link" aria-label="Direct link to field-reducers" title="Direct link to field-reducers" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> DbConnection</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> reducers</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteReducers</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>reducers</code> field of the <code>DbConnection</code> provides access to reducers exposed by the remote module. See <a href="#observe-and-invoke-reducers">Observe and invoke reducers</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="interface-dbcontext">Interface <code>DbContext</code><a href="#interface-dbcontext" class="hash-link" aria-label="Direct link to interface-dbcontext" title="Direct link to interface-dbcontext" translate="no">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">interface</span><span style="color:#8BE9FD;font-style:italic"> DbContext</span><span style="color:#F8F8F2">&lt;</span></span>
<span class="line"><span style="color:#FFB86C;font-style:italic">    DbView</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#FFB86C;font-style:italic">    Reducers</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">&gt;</span></span></code></pre>
<p><a href="#type-dbconnection"><code>DbConnection</code></a>, <a href="#type-eventcontext"><code>EventContext</code></a>, <a href="#type-reducereventcontext"><code>ReducerEventContext</code></a>, <a href="#type-subscriptioneventcontext"><code>SubscriptionEventContext</code></a> and <a href="#type-errorcontext"><code>ErrorContext</code></a> all implement <code>DbContext</code>. <code>DbContext</code> has fields and methods for inspecting and configuring your connection to the remote database.</p>
<p>The <code>DbContext</code> interface is implemented by connections and contexts to <em>every</em> module. This means that its <a href="#field-db"><code>DbView</code></a> and <a href="#field-reducers"><code>Reducers</code></a> are generic types.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#field-db"><code>db</code> field</a></td><td>Access subscribed rows of tables and register row callbacks.</td></tr><tr><td><a href="#field-reducers"><code>reducers</code> field</a></td><td>Request reducer invocations and register reducer callbacks.</td></tr><tr><td><a href="#method-disconnect"><code>disconnect</code> method</a></td><td>End the connection.</td></tr><tr><td><a href="#subscribe-to-queries">Subscribe to queries</a></td><td>Register SQL queries to receive updates about matching rows.</td></tr><tr><td><a href="#read-connection-metadata">Read connection metadata</a></td><td>Access the connection&#x27;s <code>Identity</code> and <code>ConnectionId</code></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="field-db-1">Field <code>db</code><a href="#field-db-1" class="hash-link" aria-label="Direct link to field-db-1" title="Direct link to field-db-1" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">interface</span><span style="color:#8BE9FD;font-style:italic"> DbContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  db</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> DbView</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>db</code> field of a <code>DbContext</code> provides access to the subscribed view of the remote database&#x27;s tables. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="field-reducers-1">Field <code>reducers</code><a href="#field-reducers-1" class="hash-link" aria-label="Direct link to field-reducers-1" title="Direct link to field-reducers-1" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">interface</span><span style="color:#8BE9FD;font-style:italic"> DbContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  reducers</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Reducers</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>reducers</code> field of a <code>DbContext</code> provides access to reducers exposed by the remote module. See <a href="#observe-and-invoke-reducers">Observe and invoke reducers</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="method-disconnect">Method <code>disconnect</code><a href="#method-disconnect" class="hash-link" aria-label="Direct link to method-disconnect" title="Direct link to method-disconnect" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">interface</span><span style="color:#8BE9FD;font-style:italic"> DbContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  disconnect</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Gracefully close the <code>DbConnection</code>. Throws an error if the connection is already disconnected.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="subscribe-to-queries">Subscribe to queries<a href="#subscribe-to-queries" class="hash-link" aria-label="Direct link to Subscribe to queries" title="Direct link to Subscribe to queries" translate="no">​</a></h3>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#type-subscriptionbuilder"><code>SubscriptionBuilder</code> type</a></td><td>Builder-pattern constructor to register subscribed queries.</td></tr><tr><td><a href="#type-subscriptionhandle"><code>SubscriptionHandle</code> type</a></td><td>Manage an active subscripion.</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="type-subscriptionbuilder">Type <code>SubscriptionBuilder</code><a href="#type-subscriptionbuilder" class="hash-link" aria-label="Direct link to type-subscriptionbuilder" title="Direct link to type-subscriptionbuilder" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">SubscriptionBuilder;</span></span></code></pre>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#constructor-ctxsubscriptionbuilder"><code>ctx.subscriptionBuilder()</code> constructor</a></td><td>Begin configuring a new subscription.</td></tr><tr><td><a href="#callback-onapplied"><code>onApplied</code> callback</a></td><td>Register a callback to run when matching rows become available.</td></tr><tr><td><a href="#callback-onerror"><code>onError</code> callback</a></td><td>Register a callback to run if the subscription fails.</td></tr><tr><td><a href="#method-subscribe"><code>subscribe</code> method</a></td><td>Finish configuration and subscribe to one or more SQL queries.</td></tr><tr><td><a href="#method-subscribetoalltables"><code>subscribeToAllTables</code> method</a></td><td>Convenience method to subscribe to the entire database.</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="constructor-ctxsubscriptionbuilder">Constructor <code>ctx.subscriptionBuilder()</code><a href="#constructor-ctxsubscriptionbuilder" class="hash-link" aria-label="Direct link to constructor-ctxsubscriptionbuilder" title="Direct link to constructor-ctxsubscriptionbuilder" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">interface</span><span style="color:#8BE9FD;font-style:italic"> DbContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  subscriptionBuilder</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> SubscriptionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Subscribe to queries by calling <code>ctx.subscription_builder()</code> and chaining configuration methods, then calling <code>.subscribe(queries)</code>.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="callback-onapplied">Callback <code>onApplied</code><a href="#callback-onapplied" class="hash-link" aria-label="Direct link to callback-onapplied" title="Direct link to callback-onapplied" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onApplied</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> SubscriptionEventContext</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> SubscriptionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Register a callback to run when the subscription is applied and the matching rows are inserted into the client cache.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="callback-onerror">Callback <code>onError</code><a href="#callback-onerror" class="hash-link" aria-label="Direct link to callback-onerror" title="Direct link to callback-onerror" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onError</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ErrorContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">error</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Error</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> SubscriptionBuilder</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Register a callback to run if the subscription is rejected or unexpectedly terminated by the server. This is most frequently caused by passing an invalid query to <a href="#method-subscribe"><code>subscribe</code></a>.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="method-subscribe">Method <code>subscribe</code><a href="#method-subscribe" class="hash-link" aria-label="Direct link to method-subscribe" title="Direct link to method-subscribe" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  subscribe</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">queries</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#FF79C6"> |</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2">[])</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> SubscriptionHandle</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Subscribe to a set of queries.</p>
<p>See <a href="/sql#subscriptions">the SpacetimeDB SQL Reference</a> for information on the queries SpacetimeDB supports as subscriptions.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="method-subscribetoalltables">Method <code>subscribeToAllTables</code><a href="#method-subscribetoalltables" class="hash-link" aria-label="Direct link to method-subscribetoalltables" title="Direct link to method-subscribetoalltables" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionBuilder</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">  subscribeToAllTables</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Subscribe to all rows from all public tables. This method is provided as a convenience for simple clients. The subscription initiated by <code>subscribeToAllTables</code> cannot be canceled after it is initiated. You should <a href="#method-subscribe"><code>subscribe</code> to specific queries</a> if you need fine-grained control over the lifecycle of your subscriptions.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="type-subscriptionhandle">Type <code>SubscriptionHandle</code><a href="#type-subscriptionhandle" class="hash-link" aria-label="Direct link to type-subscriptionhandle" title="Direct link to type-subscriptionhandle" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">SubscriptionHandle;</span></span></code></pre>
<p>A <code>SubscriptionHandle</code> represents a subscribed query or a group of subscribed queries.</p>
<p>The <code>SubscriptionHandle</code> does not contain or provide access to the subscribed rows. Subscribed rows of all subscriptions by a connection are contained within that connection&#x27;s <a href="#field-db"><code>ctx.db</code></a>. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#method-isended"><code>isEnded</code> method</a></td><td>Determine whether the subscription has ended.</td></tr><tr><td><a href="#method-isactive"><code>isActive</code> method</a></td><td>Determine whether the subscription is active and its matching rows are present in the client cache.</td></tr><tr><td><a href="#method-unsubscribe"><code>unsubscribe</code> method</a></td><td>Discard a subscription.</td></tr><tr><td><a href="#method-unsubscribethen"><code>unsubscribeThen</code> method</a></td><td>Discard a subscription, and register a callback to run when its matching rows are removed from the client cache.</td></tr></tbody></table>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="method-isended">Method <code>isEnded</code><a href="#method-isended" class="hash-link" aria-label="Direct link to method-isended" title="Direct link to method-isended" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> isEnded</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> bool</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Returns true if this subscription has been terminated due to an unsubscribe call or an error.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="method-isactive">Method <code>isActive</code><a href="#method-isactive" class="hash-link" aria-label="Direct link to method-isactive" title="Direct link to method-isactive" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> isActive</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> bool</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Returns true if this subscription has been applied and has not yet been unsubscribed.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="method-unsubscribe">Method <code>unsubscribe</code><a href="#method-unsubscribe" class="hash-link" aria-label="Direct link to method-unsubscribe" title="Direct link to method-unsubscribe" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> unsubscribe</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Terminate this subscription, causing matching rows to be removed from the client cache. Any rows removed from the client cache this way will have <a href="#callback-ondelete"><code>onDelete</code> callbacks</a> run for them.</p>
<p>Unsubscribing is an asynchronous operation. Matching rows are not removed from the client cache immediately. Use <a href="#method-unsubscribethen"><code>unsubscribeThen</code></a> to run a callback once the unsubscribe operation is completed.</p>
<p>Throws an error if the subscription has already ended, either due to a previous call to <code>unsubscribe</code> or <a href="#method-unsubscribethen"><code>unsubscribeThen</code></a>, or due to an error.</p>
<h5 class="anchor anchorWithStickyNavbar_wKCU" id="method-unsubscribethen">Method <code>unsubscribeThen</code><a href="#method-unsubscribethen" class="hash-link" aria-label="Direct link to method-unsubscribethen" title="Direct link to method-unsubscribethen" translate="no">​</a></h5>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> unsubscribeThen</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">on_end</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> SubscriptionEventContext</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Terminate this subscription, and run the <code>onEnd</code> callback when the subscription is ended and its matching rows are removed from the client cache. Any rows removed from the client cache this way will have <a href="#callback-ondelete"><code>onDelete</code> callbacks</a> run for them.</p>
<p>Returns an error if the subscription has already ended, either due to a previous call to <a href="#method-unsubscribe"><code>unsubscribe</code></a> or <code>unsubscribeThen</code>, or due to an error.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="read-connection-metadata">Read connection metadata<a href="#read-connection-metadata" class="hash-link" aria-label="Direct link to Read connection metadata" title="Direct link to Read connection metadata" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="field-isactive">Field <code>isActive</code><a href="#field-isactive" class="hash-link" aria-label="Direct link to field-isactive" title="Direct link to field-isactive" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">interface</span><span style="color:#8BE9FD;font-style:italic"> DbContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  isActive</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> bool</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p><code>true</code> if the connection has not yet disconnected. Note that a connection <code>isActive</code> when it is constructed, before its <a href="#callback-onconnect"><code>onConnect</code> callback</a> is invoked.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="type-eventcontext">Type <code>EventContext</code><a href="#type-eventcontext" class="hash-link" aria-label="Direct link to type-eventcontext" title="Direct link to type-eventcontext" translate="no">​</a></h2>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">EventContext;</span></span></code></pre>
<p>An <code>EventContext</code> is a <a href="#interface-dbcontext"><code>DbContext</code></a> augmented with a field <a href="#type-event"><code>event: Event</code></a>. <code>EventContext</code>s are passed as the first argument to row callbacks <a href="#callback-oninsert"><code>onInsert</code></a>, <a href="#callback-ondelete"><code>onDelete</code></a> and <a href="#callback-onupdate"><code>onUpdate</code></a>.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#field-event"><code>event</code> field</a></td><td>Enum describing the cause of the current row callback.</td></tr><tr><td><a href="#field-db"><code>db</code> field</a></td><td>Provides access to the client cache.</td></tr><tr><td><a href="#field-reducers"><code>reducers</code> field</a></td><td>Allows requesting reducers run on the remote database.</td></tr><tr><td><a href="#type-event"><code>Event</code> type</a></td><td>Possible events which can cause a row callback to be invoked.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-event">Field <code>event</code><a href="#field-event" class="hash-link" aria-label="Direct link to field-event" title="Direct link to field-event" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> EventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> event</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Event</span><span style="color:#F8F8F2">&lt;</span><span style="color:#FFB86C;font-style:italic">Reducer</span><span style="color:#F8F8F2">&gt;;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"><span style="color:#6272A4">/* other fields */</span></span></code></pre>
<p>The <a href="#type-event"><code>Event</code></a> contained in the <code>EventContext</code> describes what happened to cause the current row callback to be invoked.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-db-2">Field <code>db</code><a href="#field-db-2" class="hash-link" aria-label="Direct link to field-db-2" title="Direct link to field-db-2" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> EventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> db</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteTables</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>db</code> field of the context provides access to the subscribed view of the remote database&#x27;s tables. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-reducers-2">Field <code>reducers</code><a href="#field-reducers-2" class="hash-link" aria-label="Direct link to field-reducers-2" title="Direct link to field-reducers-2" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> EventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> reducers</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteReducers</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>reducers</code> field of the context provides access to reducers exposed by the remote module. See <a href="#observe-and-invoke-reducers">Observe and invoke reducers</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="type-event">Type <code>Event</code><a href="#type-event" class="hash-link" aria-label="Direct link to type-event" title="Direct link to type-event" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">type</span><span style="color:#8BE9FD;font-style:italic"> Event</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD;font-style:italic">Reducer</span><span style="color:#F8F8F2">&gt; </span><span style="color:#FF79C6">=</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;Reducer&#x27;</span><span style="color:#F8F8F2">; value</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ReducerEvent</span><span style="color:#F8F8F2">&lt;</span><span style="color:#8BE9FD;font-style:italic">Reducer</span><span style="color:#F8F8F2">&gt; }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;SubscribeApplied&#x27;</span><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;UnsubscribeApplied&#x27;</span><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;Error&#x27;</span><span style="color:#F8F8F2">; value</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Error</span><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;UnknownTransaction&#x27;</span><span style="color:#F8F8F2"> };</span></span></code></pre>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#variant-reducer"><code>Reducer</code> variant</a></td><td>A reducer ran in the remote database.</td></tr><tr><td><a href="#variant-subscribeapplied"><code>SubscribeApplied</code> variant</a></td><td>A new subscription was applied to the client cache.</td></tr><tr><td><a href="#variant-unsubscribeapplied"><code>UnsubscribeApplied</code> variant</a></td><td>A previous subscription was removed from the client cache after a call to <a href="#method-unsubscribe"><code>unsubscribe</code></a>.</td></tr><tr><td><a href="#variant-error"><code>Error</code> variant</a></td><td>A previous subscription was removed from the client cache due to an error.</td></tr><tr><td><a href="#variant-unknowntransaction"><code>UnknownTransaction</code> variant</a></td><td>A transaction ran in the remote database, but was not attributed to a known reducer.</td></tr><tr><td><a href="#type-reducerevent"><code>ReducerEvent</code> type</a></td><td>Metadata about a reducer run. Contained in <a href="#variant-reducer"><code>Event::Reducer</code></a> and <a href="#type-reducereventcontext"><code>ReducerEventContext</code></a>.</td></tr><tr><td><a href="#type-updatestatus"><code>UpdateStatus</code> type</a></td><td>Completion status of a reducer run.</td></tr><tr><td><a href="#type-reducer"><code>Reducer</code> type</a></td><td>Module-specific generated enum with a variant for each reducer defined by the module.</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-reducer">Variant <code>Reducer</code><a href="#variant-reducer" class="hash-link" aria-label="Direct link to variant-reducer" title="Direct link to variant-reducer" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">Reducer</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  value: ReducerEvent</span><span style="color:#FF79C6">&lt;</span><span style="color:#F8F8F2">Reducer</span><span style="color:#FF79C6">&gt;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Event when we are notified that a reducer ran in the remote database. The <a href="#type-reducerevent"><code>ReducerEvent</code></a> contains metadata about the reducer run, including its arguments and termination status(#type-updatestatus).</p>
<p>This event is passed to row callbacks resulting from modifications by the reducer.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-subscribeapplied">Variant <code>SubscribeApplied</code><a href="#variant-subscribeapplied" class="hash-link" aria-label="Direct link to variant-subscribeapplied" title="Direct link to variant-subscribeapplied" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">SubscribeApplied</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Event when our subscription is applied and its rows are inserted into the client cache.</p>
<p>This event is passed to <a href="#callback-oninsert">row <code>onInsert</code> callbacks</a> resulting from the new subscription.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-unsubscribeapplied">Variant <code>UnsubscribeApplied</code><a href="#variant-unsubscribeapplied" class="hash-link" aria-label="Direct link to variant-unsubscribeapplied" title="Direct link to variant-unsubscribeapplied" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">UnsubscribeApplied</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Event when our subscription is removed after a call to <a href="#method-unsubscribe"><code>SubscriptionHandle.unsubscribe</code></a> or <a href="#method-unsubscribethen"><code>SubscriptionHandle.unsubscribeThen</code></a> and its matching rows are deleted from the client cache.</p>
<p>This event is passed to <a href="#callback-ondelete">row <code>onDelete</code> callbacks</a> resulting from the subscription ending.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-error">Variant <code>Error</code><a href="#variant-error" class="hash-link" aria-label="Direct link to variant-error" title="Direct link to variant-error" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">Error</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  value: Error;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Event when a subscription ends unexpectedly due to an error.</p>
<p>This event is passed to <a href="#callback-ondelete">row <code>onDelete</code> callbacks</a> resulting from the subscription ending.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-unknowntransaction">Variant <code>UnknownTransaction</code><a href="#variant-unknowntransaction" class="hash-link" aria-label="Direct link to variant-unknowntransaction" title="Direct link to variant-unknowntransaction" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">UnknownTransaction</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Event when we are notified of a transaction in the remote database which we cannot associate with a known reducer. This may be an ad-hoc SQL query or a reducer for which we do not have bindings.</p>
<p>This event is passed to <a href="#callback-oninsert">row callbacks</a> resulting from modifications by the transaction.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="type-reducerevent">Type <code>ReducerEvent</code><a href="#type-reducerevent" class="hash-link" aria-label="Direct link to type-reducerevent" title="Direct link to type-reducerevent" translate="no">​</a></h3>
<p>A <code>ReducerEvent</code> contains metadata about a reducer run.</p>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">type</span><span style="color:#8BE9FD;font-style:italic"> ReducerEvent</span><span style="color:#F8F8F2">&lt;</span><span style="color:#FFB86C;font-style:italic">Reducer</span><span style="color:#F8F8F2">&gt; </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">  /**</span></span>
<span class="line"><span style="color:#6272A4">   * The time when the reducer started running.</span></span>
<span class="line"><span style="color:#6272A4">   */</span></span>
<span class="line"><span style="color:#F8F8F2">  timestamp</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Timestamp</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  /**</span></span>
<span class="line"><span style="color:#6272A4">   * Whether the reducer committed, was aborted due to insufficient energy, or failed with an error message.</span></span>
<span class="line"><span style="color:#6272A4">   */</span></span>
<span class="line"><span style="color:#F8F8F2">  status</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> UpdateStatus</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  /**</span></span>
<span class="line"><span style="color:#6272A4">   * The identity of the caller.</span></span>
<span class="line"><span style="color:#6272A4">   * TODO: Revise these to reflect the forthcoming Identity proposal.</span></span>
<span class="line"><span style="color:#6272A4">   */</span></span>
<span class="line"><span style="color:#F8F8F2">  callerIdentity</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Identity</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  /**</span></span>
<span class="line"><span style="color:#6272A4">   * The connection ID of the caller.</span></span>
<span class="line"><span style="color:#6272A4">   *</span></span>
<span class="line"><span style="color:#6272A4">   * May be `null`, e.g. for scheduled reducers.</span></span>
<span class="line"><span style="color:#6272A4">   */</span></span>
<span class="line"><span style="color:#F8F8F2">  callerConnectionId</span><span style="color:#FF79C6">?:</span><span style="color:#8BE9FD;font-style:italic"> ConnectionId</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  /**</span></span>
<span class="line"><span style="color:#6272A4">   * The amount of energy consumed by the reducer run, in eV.</span></span>
<span class="line"><span style="color:#6272A4">   * (Not literal eV, but our SpacetimeDB energy unit eV.)</span></span>
<span class="line"><span style="color:#6272A4">   * May be present or undefined at the implementor&#x27;s discretion;</span></span>
<span class="line"><span style="color:#6272A4">   * future work may determine an interface for module developers</span></span>
<span class="line"><span style="color:#6272A4">   * to request this value be published or hidden.</span></span>
<span class="line"><span style="color:#6272A4">   */</span></span>
<span class="line"><span style="color:#F8F8F2">  energyConsumed</span><span style="color:#FF79C6">?:</span><span style="color:#8BE9FD;font-style:italic"> bigint</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  /**</span></span>
<span class="line"><span style="color:#6272A4">   * The `Reducer` enum defined by the `moduleBindings`, which encodes which reducer ran and its arguments.</span></span>
<span class="line"><span style="color:#6272A4">   */</span></span>
<span class="line"><span style="color:#F8F8F2">  reducer</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Reducer</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span></code></pre>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="type-updatestatus">Type <code>UpdateStatus</code><a href="#type-updatestatus" class="hash-link" aria-label="Direct link to type-updatestatus" title="Direct link to type-updatestatus" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">type</span><span style="color:#8BE9FD;font-style:italic"> UpdateStatus</span><span style="color:#FF79C6"> =</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> &#x27;</span><span style="color:#F1FA8C">Committed</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">; value</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> __DatabaseUpdate</span><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> &#x27;</span><span style="color:#F1FA8C">Failed</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">; value</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> string</span><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { tag</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> &#x27;</span><span style="color:#F1FA8C">OutOfEnergy</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2"> };</span></span></code></pre>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#variant-committed"><code>Committed</code> variant</a></td><td>The reducer ran successfully.</td></tr><tr><td><a href="#variant-failed"><code>Failed</code> variant</a></td><td>The reducer errored.</td></tr><tr><td><a href="#variant-outofenergy"><code>OutOfEnergy</code> variant</a></td><td>The reducer was aborted due to insufficient energy.</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-committed">Variant <code>Committed</code><a href="#variant-committed" class="hash-link" aria-label="Direct link to variant-committed" title="Direct link to variant-committed" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">Committed</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The reducer returned successfully and its changes were committed into the database state. An <a href="#variant-reducer"><code>Event</code> with <code>tag: &#x27;Reducer&#x27;</code></a> passed to a row callback must have this status in its <a href="#type-reducerevent"><code>ReducerEvent</code></a>.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-failed">Variant <code>Failed</code><a href="#variant-failed" class="hash-link" aria-label="Direct link to variant-failed" title="Direct link to variant-failed" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">Failed</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  value: string;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The reducer returned an error, panicked, or threw an exception. The <code>value</code> is the stringified error message. Formatting of the error message is unstable and subject to change, so clients should use it only as a human-readable diagnostic, and in particular should not attempt to parse the message.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="variant-outofenergy">Variant <code>OutOfEnergy</code><a href="#variant-outofenergy" class="hash-link" aria-label="Direct link to variant-outofenergy" title="Direct link to variant-outofenergy" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">  tag: </span><span style="color:#E9F284">&#x27;</span><span style="color:#F1FA8C">OutOfEnergy</span><span style="color:#E9F284">&#x27;</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The reducer was aborted due to insufficient energy balance of the module owner.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="type-reducer">Type <code>Reducer</code><a href="#type-reducer" class="hash-link" aria-label="Direct link to type-reducer" title="Direct link to type-reducer" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">type</span><span style="color:#8BE9FD;font-style:italic"> Reducer</span><span style="color:#FF79C6"> =</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { name</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;ReducerA&#x27;</span><span style="color:#F8F8F2">; args</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ReducerA</span><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#FF79C6">  |</span><span style="color:#F8F8F2"> { name</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> &#x27;ReducerB&#x27;</span><span style="color:#F8F8F2">; args</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ReducerB</span><span style="color:#F8F8F2"> }</span></span></code></pre>
<p>The module bindings contains a type <code>Reducer</code> with a variant for each reducer defined by the module. Each variant has a field <code>args</code> containing the arguments to the reducer.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="type-reducereventcontext">Type <code>ReducerEventContext</code><a href="#type-reducereventcontext" class="hash-link" aria-label="Direct link to type-reducereventcontext" title="Direct link to type-reducereventcontext" translate="no">​</a></h2>
<p>A <code>ReducerEventContext</code> is a <a href="#interface-dbcontext"><code>DbContext</code></a> augmented with a field <a href="#type-reducerevent"><code>event: ReducerEvent</code></a>. <code>ReducerEventContext</code>s are passed as the first argument to <a href="#observe-and-invoke-reducers">reducer callbacks</a>.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#field-event"><code>event</code> field</a></td><td><a href="#type-reducerevent"><code>ReducerEvent</code></a> containing reducer metadata.</td></tr><tr><td><a href="#field-db"><code>db</code> field</a></td><td>Provides access to the client cache.</td></tr><tr><td><a href="#field-reducers"><code>reducers</code> field</a></td><td>Allows requesting reducers run on the remote database.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-event-1">Field <code>event</code><a href="#field-event-1" class="hash-link" aria-label="Direct link to field-event-1" title="Direct link to field-event-1" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ReducerEventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> event</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> ReducerEvent</span><span style="color:#F8F8F2">&lt;</span><span style="color:#FFB86C;font-style:italic">Reducer</span><span style="color:#F8F8F2">&gt;;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <a href="#type-reducerevent"><code>ReducerEvent</code></a> contained in the <code>ReducerEventContext</code> has metadata about the reducer which ran.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-db-3">Field <code>db</code><a href="#field-db-3" class="hash-link" aria-label="Direct link to field-db-3" title="Direct link to field-db-3" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ReducerEventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> db</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteTables</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>db</code> field of the context provides access to the subscribed view of the remote database&#x27;s tables. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-reducers-3">Field <code>reducers</code><a href="#field-reducers-3" class="hash-link" aria-label="Direct link to field-reducers-3" title="Direct link to field-reducers-3" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ReducerEventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> reducers</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteReducers</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>reducers</code> field of the context provides access to reducers exposed by the remote module. See <a href="#observe-and-invoke-reducers">Observe and invoke reducers</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="type-subscriptioneventcontext">Type <code>SubscriptionEventContext</code><a href="#type-subscriptioneventcontext" class="hash-link" aria-label="Direct link to type-subscriptioneventcontext" title="Direct link to type-subscriptioneventcontext" translate="no">​</a></h2>
<p>A <code>SubscriptionEventContext</code> is a <a href="#interface-dbcontext"><code>DbContext</code></a>. Unlike the other context types, <code>SubscriptionEventContext</code> doesn&#x27;t have an <code>event</code> field. <code>SubscriptionEventContext</code>s are passed to subscription <a href="#callback-onapplied"><code>onApplied</code></a> and <a href="#method-unsubscribethen"><code>unsubscribeThen</code></a> callbacks.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#field-db"><code>db</code> field</a></td><td>Provides access to the client cache.</td></tr><tr><td><a href="#field-reducers"><code>reducers</code> field</a></td><td>Allows requesting reducers run on the remote database.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-db-4">Field <code>db</code><a href="#field-db-4" class="hash-link" aria-label="Direct link to field-db-4" title="Direct link to field-db-4" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionEventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> db</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteTables</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>db</code> field of the context provides access to the subscribed view of the remote database&#x27;s tables. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-reducers-4">Field <code>reducers</code><a href="#field-reducers-4" class="hash-link" aria-label="Direct link to field-reducers-4" title="Direct link to field-reducers-4" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> SubscriptionEventContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> reducers</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteReducers</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>reducers</code> field of the context provides access to reducers exposed by the remote module. See <a href="#observe-and-invoke-reducers">Observe and invoke reducers</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="type-errorcontext">Type <code>ErrorContext</code><a href="#type-errorcontext" class="hash-link" aria-label="Direct link to type-errorcontext" title="Direct link to type-errorcontext" translate="no">​</a></h2>
<p>An <code>ErrorContext</code> is a <a href="#interface-dbcontext"><code>DbContext</code></a> augmented with a field <code>event: Error</code>. <code>ErrorContext</code>s are to connections&#x27; <a href="#callback-ondisconnect"><code>onDisconnect</code></a> and <a href="#callback-onconnecterror"><code>onConnectError</code></a> callbacks, and to subscriptions&#x27; <a href="#callback-onerror"><code>onError</code></a> callbacks.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#field-event"><code>event</code> field</a></td><td>The error which caused the current error callback.</td></tr><tr><td><a href="#field-db"><code>db</code> field</a></td><td>Provides access to the client cache.</td></tr><tr><td><a href="#field-reducers"><code>reducers</code> field</a></td><td>Allows requesting reducers run on the remote database.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-event-2">Field <code>event</code><a href="#field-event-2" class="hash-link" aria-label="Direct link to field-event-2" title="Direct link to field-event-2" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ErrorContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> event</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Error</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-db-5">Field <code>db</code><a href="#field-db-5" class="hash-link" aria-label="Direct link to field-db-5" title="Direct link to field-db-5" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ErrorContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> db</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteTables</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>db</code> field of the context provides access to the subscribed view of the remote database&#x27;s tables. See <a href="#access-the-client-cache">Access the client cache</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="field-reducers-5">Field <code>reducers</code><a href="#field-reducers-5" class="hash-link" aria-label="Direct link to field-reducers-5" title="Direct link to field-reducers-5" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ErrorContext</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#F8F8F2"> reducers</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> RemoteReducers</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>reducers</code> field of the context provides access to reducers exposed by the remote module. See <a href="#observe-and-invoke-reducers">Observe and invoke reducers</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="access-the-client-cache">Access the client cache<a href="#access-the-client-cache" class="hash-link" aria-label="Direct link to Access the client cache" title="Direct link to Access the client cache" translate="no">​</a></h2>
<p>All <a href="#interface-dbcontext"><code>DbContext</code></a> implementors, including <a href="#type-dbconnection"><code>DbConnection</code></a> and <a href="#type-eventcontext"><code>EventContext</code></a>, have fields <code>.db</code>, which in turn has methods for accessing tables in the client cache.</p>
<p>Each table defined by a module has an accessor method, whose name is the table name converted to <code>camelCase</code>, on this <code>.db</code> field. The table accessor methods return table handles. Table handles have methods for <a href="#accessing-rows">accessing rows</a> and <a href="#callback-oninsert">registering <code>onInsert</code></a> and <a href="#callback-ondelete"><code>onDelete</code> callbacks</a>. Handles for tables which have a declared primary key field also expose <a href="#callback-onupdate"><code>onUpdate</code> callbacks</a>. Table handles also offer the ability to find subscribed rows by unique index.</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td><a href="#accessing-rows">Accessing rows</a></td><td>Iterate over or count subscribed rows.</td></tr><tr><td><a href="#callback-oninsert"><code>onInsert</code> callback</a></td><td>Register a function to run when a row is added to the client cache.</td></tr><tr><td><a href="#callback-ondelete"><code>onDelete</code> callback</a></td><td>Register a function to run when a row is removed from the client cache.</td></tr><tr><td><a href="#callback-onupdate"><code>onUpdate</code> callback</a></td><td>Register a function to run when a subscribed row is replaced with a new version.</td></tr><tr><td><a href="#unique-constraint-index-access">Unique index access</a></td><td>Seek a subscribed row by the value in its unique or primary key column.</td></tr><tr><td><a href="#btree-index-access">BTree index access</a></td><td>Not supported.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="accessing-rows">Accessing rows<a href="#accessing-rows" class="hash-link" aria-label="Direct link to Accessing rows" title="Direct link to Accessing rows" translate="no">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="method-count">Method <code>count</code><a href="#method-count" class="hash-link" aria-label="Direct link to method-count" title="Direct link to method-count" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> TableHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> count</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> number</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>Returns the number of rows of this table resident in the client cache, i.e. the total number which match any subscribed query.</p>
<h4 class="anchor anchorWithStickyNavbar_wKCU" id="method-iter">Method <code>iter</code><a href="#method-iter" class="hash-link" aria-label="Direct link to method-iter" title="Direct link to method-iter" translate="no">​</a></h4>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> TableHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> iter</span><span style="color:#F8F8F2">()</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Iterable</span><span style="color:#F8F8F2">&lt;</span><span style="color:#FFB86C;font-style:italic">Row</span><span style="color:#F8F8F2">&gt;;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>An iterator over all the subscribed rows in the client cache, i.e. those which match any subscribed query.</p>
<p>The <code>Row</code> type will be an autogenerated type which matches the row type defined by the module.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="callback-oninsert">Callback <code>onInsert</code><a href="#callback-oninsert" class="hash-link" aria-label="Direct link to callback-oninsert" title="Direct link to callback-oninsert" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> TableHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onInsert</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> EventContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">row</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> removeOnInsert</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> EventContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">row</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>onInsert</code> callback runs whenever a new row is inserted into the client cache, either when applying a subscription or being notified of a transaction. The passed <a href="#type-eventcontext"><code>EventContext</code></a> contains an <a href="#type-event"><code>Event</code></a> which can identify the change which caused the insertion, and also allows the callback to interact with the connection, inspect the client cache and invoke reducers.</p>
<p>The <code>Row</code> type will be an autogenerated type which matches the row type defined by the module.</p>
<p><code>removeOnInsert</code> may be used to un-register a previously-registered <code>onInsert</code> callback.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="callback-ondelete">Callback <code>onDelete</code><a href="#callback-ondelete" class="hash-link" aria-label="Direct link to callback-ondelete" title="Direct link to callback-ondelete" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> TableHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onDelete</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> EventContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">row</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> removeOnDelete</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> EventContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">row</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">)</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>onDelete</code> callback runs whenever a previously-resident row is deleted from the client cache.</p>
<p>The <code>Row</code> type will be an autogenerated type which matches the row type defined by the module.</p>
<p><code>removeOnDelete</code> may be used to un-register a previously-registered <code>onDelete</code> callback.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="callback-onupdate">Callback <code>onUpdate</code><a href="#callback-onupdate" class="hash-link" aria-label="Direct link to callback-onupdate" title="Direct link to callback-onupdate" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> TableHandle</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> onUpdate</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> EventContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">old</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">new</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  public</span><span style="color:#50FA7B"> removeOnUpdate</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">    callback</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> (</span><span style="color:#FFB86C;font-style:italic">ctx</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> EventContext</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">old</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">new</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> Row</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=&gt;</span><span style="color:#8BE9FD;font-style:italic"> void</span></span>
<span class="line"><span style="color:#F8F8F2">  )</span><span style="color:#FF79C6">:</span><span style="color:#8BE9FD;font-style:italic"> void</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<p>The <code>onUpdate</code> callback runs whenever an already-resident row in the client cache is updated, i.e. replaced with a new row that has the same primary key.</p>
<p>Only tables with a declared primary key expose <code>onUpdate</code> callbacks. Handles for tables without a declared primary key will not have <code>onUpdate</code> or <code>removeOnUpdate</code> methods.</p>
<p>The <code>Row</code> type will be an autogenerated type which matches the row type defined by the module.</p>
<p><code>removeOnUpdate</code> may be used to un-register a previously-registered <code>onUpdate</code> callback.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="unique-constraint-index-access">Unique constraint index access<a href="#unique-constraint-index-access" class="hash-link" aria-label="Direct link to Unique constraint index access" title="Direct link to Unique constraint index access" translate="no">​</a></h3>
<p>For each unique constraint on a table, its table handle has a field whose name is the unique column name. This field is a unique index handle. The unique index handle has a method <code>.find(desiredValue: Col) -&gt; Row | undefined</code>, where <code>Col</code> is the type of the column, and <code>Row</code> the type of rows. If a row with <code>desiredValue</code> in the unique column is resident in the client cache, <code>.find</code> returns it.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="btree-index-access">BTree index access<a href="#btree-index-access" class="hash-link" aria-label="Direct link to BTree index access" title="Direct link to BTree index access" translate="no">​</a></h3>
<p>The SpacetimeDB TypeScript client SDK does not support non-unique BTree indexes.</p>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="observe-and-invoke-reducers">Observe and invoke reducers<a href="#observe-and-invoke-reducers" class="hash-link" aria-label="Direct link to Observe and invoke reducers" title="Direct link to Observe and invoke reducers" translate="no">​</a></h2>
<p>All <a href="#interface-dbcontext"><code>DbContext</code></a> implementors, including <a href="#type-dbconnection"><code>DbConnection</code></a> and <a href="#type-eventcontext"><code>EventContext</code></a>, have fields <code>.reducers</code>, which in turn has methods for invoking reducers defined by the module and registering callbacks on it.</p>
<p>Each reducer defined by the module has three methods on the <code>.reducers</code>:</p>
<ul>
<li>An invoke method, whose name is the reducer&#x27;s name converted to camel case, like <code>setName</code>. This requests that the module run the reducer.</li>
<li>A callback registation method, whose name is prefixed with <code>on</code>, like <code>onSetName</code>. This registers a callback to run whenever we are notified that the reducer ran, including successfully committed runs and runs we requested which failed. This method returns a callback id, which can be passed to the callback remove method.</li>
<li>A callback remove method, whose name is prefixed with <code>removeOn</code>, like <code>removeOnSetName</code>. This cancels a callback previously registered via the callback registration method.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_wKCU" id="identify-a-client">Identify a client<a href="#identify-a-client" class="hash-link" aria-label="Direct link to Identify a client" title="Direct link to Identify a client" translate="no">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="type-identity">Type <code>Identity</code><a href="#type-identity" class="hash-link" aria-label="Direct link to type-identity" title="Direct link to type-identity" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#8BE9FD;font-style:italic">Identity</span></span></code></pre>
<p>A unique public identifier for a client connected to a database.</p>
<h3 class="anchor anchorWithStickyNavbar_wKCU" id="type-connectionid">Type <code>ConnectionId</code><a href="#type-connectionid" class="hash-link" aria-label="Direct link to type-connectionid" title="Direct link to type-connectionid" translate="no">​</a></h3>
<pre tabindex="0" class="codeBlockStandalone_pMzE thin-scrollbar codeBlockContainer_HZVP theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_ckKi"><span class="line"><span style="color:#8BE9FD;font-style:italic">ConnectionId</span></span></code></pre>
<p>An opaque identifier for a client connection to a database, intended to differentiate between connections from the same <a href="#type-identity"><code>Identity</code></a>.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/sdks/typescript/quickstart"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">TypeScript Quickstart</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sql"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SQL Reference</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Ea_L thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#project-setup" class="table-of-contents__link toc-highlight">Project setup</a><ul><li><a href="#tip-for-utilitiesscripts" class="table-of-contents__link toc-highlight">Tip for utilities/scripts</a></li></ul></li><li><a href="#generate-module-bindings" class="table-of-contents__link toc-highlight">Generate module bindings</a></li><li><a href="#type-dbconnection" class="table-of-contents__link toc-highlight">Type <code>DbConnection</code></a><ul><li><a href="#connect-to-a-database" class="table-of-contents__link toc-highlight">Connect to a database</a></li><li><a href="#access-tables-and-reducers" class="table-of-contents__link toc-highlight">Access tables and reducers</a></li></ul></li><li><a href="#interface-dbcontext" class="table-of-contents__link toc-highlight">Interface <code>DbContext</code></a><ul><li><a href="#method-disconnect" class="table-of-contents__link toc-highlight">Method <code>disconnect</code></a></li><li><a href="#subscribe-to-queries" class="table-of-contents__link toc-highlight">Subscribe to queries</a></li><li><a href="#read-connection-metadata" class="table-of-contents__link toc-highlight">Read connection metadata</a></li></ul></li><li><a href="#type-eventcontext" class="table-of-contents__link toc-highlight">Type <code>EventContext</code></a><ul><li><a href="#field-event" class="table-of-contents__link toc-highlight">Field <code>event</code></a></li><li><a href="#field-db-2" class="table-of-contents__link toc-highlight">Field <code>db</code></a></li><li><a href="#field-reducers-2" class="table-of-contents__link toc-highlight">Field <code>reducers</code></a></li><li><a href="#type-event" class="table-of-contents__link toc-highlight">Type <code>Event</code></a></li><li><a href="#type-reducerevent" class="table-of-contents__link toc-highlight">Type <code>ReducerEvent</code></a></li><li><a href="#type-updatestatus" class="table-of-contents__link toc-highlight">Type <code>UpdateStatus</code></a></li><li><a href="#type-reducer" class="table-of-contents__link toc-highlight">Type <code>Reducer</code></a></li></ul></li><li><a href="#type-reducereventcontext" class="table-of-contents__link toc-highlight">Type <code>ReducerEventContext</code></a><ul><li><a href="#field-event-1" class="table-of-contents__link toc-highlight">Field <code>event</code></a></li><li><a href="#field-db-3" class="table-of-contents__link toc-highlight">Field <code>db</code></a></li><li><a href="#field-reducers-3" class="table-of-contents__link toc-highlight">Field <code>reducers</code></a></li></ul></li><li><a href="#type-subscriptioneventcontext" class="table-of-contents__link toc-highlight">Type <code>SubscriptionEventContext</code></a><ul><li><a href="#field-db-4" class="table-of-contents__link toc-highlight">Field <code>db</code></a></li><li><a href="#field-reducers-4" class="table-of-contents__link toc-highlight">Field <code>reducers</code></a></li></ul></li><li><a href="#type-errorcontext" class="table-of-contents__link toc-highlight">Type <code>ErrorContext</code></a><ul><li><a href="#field-event-2" class="table-of-contents__link toc-highlight">Field <code>event</code></a></li><li><a href="#field-db-5" class="table-of-contents__link toc-highlight">Field <code>db</code></a></li><li><a href="#field-reducers-5" class="table-of-contents__link toc-highlight">Field <code>reducers</code></a></li></ul></li><li><a href="#access-the-client-cache" class="table-of-contents__link toc-highlight">Access the client cache</a><ul><li><a href="#accessing-rows" class="table-of-contents__link toc-highlight">Accessing rows</a></li><li><a href="#callback-oninsert" class="table-of-contents__link toc-highlight">Callback <code>onInsert</code></a></li><li><a href="#callback-ondelete" class="table-of-contents__link toc-highlight">Callback <code>onDelete</code></a></li><li><a href="#callback-onupdate" class="table-of-contents__link toc-highlight">Callback <code>onUpdate</code></a></li><li><a href="#unique-constraint-index-access" class="table-of-contents__link toc-highlight">Unique constraint index access</a></li><li><a href="#btree-index-access" class="table-of-contents__link toc-highlight">BTree index access</a></li></ul></li><li><a href="#observe-and-invoke-reducers" class="table-of-contents__link toc-highlight">Observe and invoke reducers</a></li><li><a href="#identify-a-client" class="table-of-contents__link toc-highlight">Identify a client</a><ul><li><a href="#type-identity" class="table-of-contents__link toc-highlight">Type <code>Identity</code></a></li><li><a href="#type-connectionid" class="table-of-contents__link toc-highlight">Type <code>ConnectionId</code></a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"></div></footer></div>
</body>
</html>